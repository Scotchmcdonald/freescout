includes:
    - vendor/larastan/larastan/extension.neon

parameters:
    level: 8
    paths:
        - app
        - config
        - database
        - routes
    
    
    # Ignore patterns
    excludePaths:
        - archive/*
        - vendor/*
        - storage/*
        - bootstrap/cache/*
    
    # Laravel specific
    checkModelProperties: true
    checkOctaneCompatibility: true
    
    # Ignore errors during initial setup
    reportUnmatchedIgnoredErrors: false
    
    # Custom rules - merged from both sections
    ignoreErrors:
        # View-string type issues in controllers
        # These are false positives - literal strings are valid view names
        -
            message: '#Parameter \#1 \$view of function view expects view-string\|null, string given#'
            path: app/Http/Controllers
        -
            message: '#PHPDoc tag `@var` for variable \$viewName contains unresolvable type#'
            path: app/Http/Controllers
        # Module facade dynamic methods
        -
            message: '#Call to an undefined static method Nwidart\\Modules\\Facades\\Module::findByAlias\(\)#'
            path: app/Http/Controllers/ModulesController.php


        # MailboxPolicy pivot access (BelongsToMany pivot is dynamic)
        -
            message: '#Access to an undefined property Illuminate\\Database\\Eloquent\\Model::\$pivot#'
            path: app/Policies/MailboxPolicy.php
        # Third-party IMAP library missing method definitions
        -
            message: '#Call to an undefined method Webklex\\PHPIMAP\\Query\\WhereQuery::setCharset\(\)#'
            path: app/Services/ImapService.php
        -
            message: '#Call to an undefined method Webklex\\PHPIMAP\\Message::getRawHeader\(\)#'
            path: app/Services/ImapService.php
        # ImapService complex type issues with IMAP library
        -
            message: '#Parameter .* of method App\\Services\\ImapService::getEncryption\(\) expects int\|null, string\|null given#'
            paths:
                - app/Services/ImapService.php
                - app/Services/SmtpService.php
        -
            message: '#Parameter .* of method App\\Services\\SmtpService::getEncryption\(\) expects int\|null, string\|null given#'
            path: app/Services/SmtpService.php
        -
            message: '#Parameter \#2 \$string of function explode expects string, array given#'
            path: app/Services/ImapService.php
        -
            message: '#Call to function is_object\(\) .* will always evaluate to true#'
            path: app/Services/ImapService.php
        -
            message: '#Call to function method_exists\(\) .* will always evaluate to true#'
            path: app/Services/ImapService.php
        -
            message: '#Left side of && is always true#'
            path: app/Services/ImapService.php
        -
            message: '#Parameter \#1 \$json of function json_decode expects string, array given#'
            path: app/Services/ImapService.php
        -
            message: '#Property App\\Models\\Conversation::\$.* does not accept#'
            path: app/Services/ImapService.php
        -
            message: '#Offset .* on non-empty-list.* in isset\(\) always exists#'
            path: app/Services/ImapService.php
        -
            message: '#Access to an undefined property Illuminate\\Database\\Eloquent\\Model::\$id#'
            paths:
                - app/Services/ImapService.php
                - app/Http/Controllers/ConversationController.php
        -
            message: '#Negated boolean expression is always false#'
            path: app/Services/ImapService.php
        -
            message: '#Ternary operator condition is always true#'
            path: app/Services/ImapService.php
        -
            message: '#Using nullsafe method call on non-nullable type Webklex\\PHPIMAP\\Attribute#'
            path: app/Services/ImapService.php
        -
            message: '#Parameter \#1 \$email_address of static method App\\Misc\\MailHelper::generateMessageId\(\) expects string, Webklex\\PHPIMAP\\Attribute given#'
            path: app/Services/ImapService.php





        # Ignore missing typehints during migration
        -
            identifier: missingType.iterableValue
        -
            identifier: missingType.generics
