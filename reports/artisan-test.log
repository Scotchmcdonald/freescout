
   PASS  Tests\Unit\ActivityLogModelTest
  ✓ model can be instantiated                                            0.14s  
  ✓ model has fillable attributes                                        0.01s  
  ✓ properties cast to json                                              0.01s  
  ✓ scope in log filters by log name                                     0.01s  
  ✓ scope caused by filters by causer                                    0.04s  
  ✓ scope for subject filters by subject                                 0.02s  
  ✓ user method returns user when causer is user                         0.01s  
  ✓ user method returns null when causer is not user                     0.01s  
  ✓ subject morph relationship                                           0.01s  
  ✓ causer morph relationship                                            0.01s  
  ✓ activity log with null properties                                    0.01s  
  ✓ activity log with empty properties array                             0.01s  
  ✓ activity log with null batch uuid                                    0.01s  
  ✓ activity log with batch uuid                                         0.01s  
  ✓ multiple activity logs for same subject                              0.01s  
  ✓ scope filters can be combined                                        0.01s  
  ✓ created at and updated at cast to datetime                           0.01s  

   PASS  Tests\Unit\AttachmentModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes
  ✓ filename size and mime type are stored                               0.01s  
  ✓ embedded cast to boolean                                             0.02s  
  ✓ image mime types can be detected                                     0.02s  
  ✓ is image method works                                                0.02s  
  ✓ belongs to thread                                                    0.02s  

   PASS  Tests\Unit\ChannelModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes

   PASS  Tests\Unit\Commands\ConfigureGmailMailboxCommandTest
  ✓ command can be instantiated                                          0.01s  
  ✓ command has signature
  ✓ command has description

   PASS  Tests\Unit\Controllers\Auth\AuthenticatedSessionControllerTest
  ✓ create shows login form                                              0.03s  
  ✓ store authenticates user with valid credentials                      0.02s  
  ✓ store fails with invalid credentials                                 0.21s  
  ✓ store validates required fields                                      0.01s  
  ✓ destroy logs out user                                                0.01s  
  ✓ destroy clears session                                               0.01s  
  ✓ destroy invalidates remember token                                   0.01s  
  ✓ authenticated users redirected from login                            0.01s  
  ✓ login with remember me                                               0.01s  
  ✓ failed login preserves email                                         0.21s  
  ✓ post logout redirect                                                 0.01s  

   PASS  Tests\Unit\Controllers\Auth\ConfirmablePasswordControllerTest
  ✓ show displays confirmation form                                      0.02s  
  ✓ store confirms with correct password                                 0.01s  
  ✓ store fails with incorrect password                                  0.21s  
  ✓ store validates password required                                    0.21s  
  ✓ store sets confirmation timestamp                                    0.01s  
  ✓ guest cannot confirm password                                        0.01s  
  ✓ guest cannot submit password confirmation                            0.01s  
  ✓ confirmation persists in session                                     0.01s  

   PASS  Tests\Unit\Controllers\Auth\EmailVerificationReminderControllerTest
  ✓ user can request verification email                                  0.05s  
  ✓ verified user redirected when requesting verification                0.01s  
  ✓ guest cannot request verification email                              0.01s  
  ✓ verification email rate limited                                      0.03s  

   PASS  Tests\Unit\Controllers\Auth\NewPasswordControllerTest
  ✓ password can be reset with valid token                               0.02s  
  ✓ password reset fails with invalid token                              0.21s  
  ✓ password must meet requirements                                      0.01s  
  ✓ password must be confirmed                                           0.01s  
  ✓ password is hashed after reset                                       0.02s  

   PASS  Tests\Unit\Controllers\Auth\PasswordResetLinkControllerTest
  ✓ create shows request form                                            0.02s  
  ✓ store sends reset link with valid email                              0.21s  
  ✓ store fails with non existent email                                  0.21s  
  ✓ store validates email required                                       0.01s  
  ✓ store validates email format                                         0.01s  
  ✓ store generates token                                                0.21s  
  ✓ guest can request password reset                                     0.21s  
  ✓ authenticated user can request password reset                        0.01s  

   FAIL  Tests\Unit\Controllers\Auth\RegisteredUserControllerTest
  ✓ create shows registration form                                       0.02s  
  ⨯ store creates user with valid data                                   0.03s  
  ✓ store validates name required                                        0.01s  
  ✓ store validates email required                                       0.01s  
  ✓ store validates email unique                                         0.01s  
  ✓ store validates password required                                    0.01s  
  ✓ store validates password confirmed                                   0.01s  
  ✓ store auto logs in user after registration                           0.02s  
  ✓ store hashes password                                                0.03s  
  ✓ authenticated users cannot register                                  0.01s  

   PASS  Tests\Unit\Controllers\Auth\VerifyEmailControllerTest
  ✓ email can be verified                                                0.02s  
  ✓ email verification requires valid signature                          0.01s  
  ✓ already verified email redirects                                     0.01s  
  ✓ guest cannot verify email                                            0.01s  

   PASS  Tests\Unit\Controllers\ConversationControllerTest
  ✓ controller can be instantiated                                       0.04s  
  ✓ index returns view for authorized user                               0.01s  
  ✓ index aborts for unauthorized user                                   0.01s  
  ✓ index only shows published conversations                             0.02s  
  ✓ show returns view for authorized user                                0.02s  
  ✓ show aborts for unauthorized user                                    0.01s  
  ✓ show loads conversation relationships                                0.02s  
  ✓ create returns view for admin                                        0.01s  
  ✓ create returns view for authorized user                              0.01s  
  ✓ create aborts for unauthorized user                                  0.01s  
  ✓ store requires subject and body                                      0.01s  
  ✓ store requires valid customer                                        0.01s  
  ✓ update requires authorization                                        0.01s  
  ✓ update can assign conversation to user                               0.02s  
  ✓ update can move to different folder                                  0.02s  
  ✓ reply adds new thread to conversation                                0.02s  
  ✓ reply requires body                                                  0.02s  
  ✓ destroy requires mailbox access                                      0.01s  

   PASS  Tests\Unit\Controllers\CustomerControllerTest
  ✓ controller can be instantiated                                       0.03s  
  ✓ index returns view                                                   0.01s  
  ✓ index passes customers to view                                       0.01s  
  ✓ index searches by first name                                         0.01s  
  ✓ index searches by last name                                          0.01s  
  ✓ show returns view                                                    0.01s  
  ✓ show loads conversations                                             0.01s  
  ✓ edit returns view                                                    0.01s  
  ✓ update returns json success response                                 0.01s  
  ✓ update accepts optional fields                                       0.01s  
  ✓ merge combines two customers                                         0.02s  
  ✓ merge prevents merging customer with itself                          0.01s  
  ✓ ajax search returns matching customers                               0.01s  
  ✓ ajax conversations returns customer conversations                    0.03s  
  ✓ ajax returns error for invalid action                                0.01s  

   PASS  Tests\Unit\Controllers\DashboardControllerTest
  ✓ controller can be instantiated                                       0.02s  
  ✓ index returns view for admin                                         0.01s  
  ✓ index returns view for regular user                                  0.01s  
  ✓ index passes user to view                                            0.01s  
  ✓ index passes mailboxes to view                                       0.01s  
  ✓ admin sees all mailboxes                                             0.01s  
  ✓ regular user sees only assigned mailboxes                            0.01s  
  ✓ index counts active conversations                                    0.02s  
  ✓ index counts unassigned conversations                                0.01s  
  ✓ index provides stats per mailbox                                     0.02s  
  ✓ index excludes closed conversations from count                       0.02s  
  ✓ index excludes draft conversations from count                        0.02s  

   PASS  Tests\Unit\Controllers\MailboxControllerEnhancedTest
  ✓ index returns view with mailboxes                                    0.04s  
  ✓ show returns view with mailbox                                       0.01s  
  ✓ settings returns view                                                0.01s  
  ✓ connection incoming requires authorization                           0.02s  
  ✓ connection outgoing requires authorization                           0.01s  
  ✓ fetch emails returns json response                                   0.05s  

   PASS  Tests\Unit\Controllers\ModulesControllerTest
  ✓ controller can be instantiated                                       0.01s  
  ✓ index returns view                                                   0.01s  
  ✓ index passes modules array to view                                   0.01s  
  ✓ enable returns error for non existent module                         0.01s  
  ✓ disable returns error for non existent module                        0.01s  
  ✓ delete returns error for non existent module                         0.01s  
  ✓ enable returns json response                                         0.01s  
  ✓ disable returns json response                                        0.01s  
  ✓ delete returns json response                                         0.01s  

   FAIL  Tests\Unit\Controllers\ProfileControllerTest
  ✓ edit shows profile form                                              0.03s  
  ⨯ update modifies profile data                                         0.01s  
  ✓ update validates email uniqueness                                    0.02s  
  ✓ update allows current user email                                     0.01s  
  ✓ update validates name required                                       0.02s  
  ⨯ update preserves unchanged fields                                    0.01s  
  ✓ destroy deletes user account                                         0.03s  

   PASS  Tests\Unit\Controllers\SystemControllerTest
  ✓ controller can be instantiated                                       0.04s  
  ✓ index returns view                                                   0.01s  
  ✓ index passes stats to view                                           0.02s  
  ✓ index stats contains correct keys                                    0.01s  
  ✓ index system info contains correct keys                              0.01s  
  ✓ index counts entities correctly                                      0.02s  
  ✓ diagnostics returns json response                                    0.01s  
  ✓ diagnostics checks database connection                               0.01s  
  ✓ diagnostics checks storage writable                                  0.01s  
  ✓ diagnostics checks cache working                                     0.01s  
  ✓ diagnostics checks required extensions                               0.01s  
  ✓ ajax returns unauthorized for non admin                              0.01s  
  ✓ ajax returns error for invalid action                                0.01s  
  ✓ ajax clear cache returns success for admin                           0.02s  
  ✓ ajax system info returns configuration                               0.02s  
  ✓ logs returns view                                                    0.01s  
  ✓ logs defaults to application type                                    0.01s  
  ✓ logs can filter by type                                              0.02s  

   FAIL  Tests\Unit\Controllers\UserControllerTest
  ✓ controller can be instantiated                                       0.05s  
  ⨯ index requires authentication                                        0.01s  
  ⨯ index accessible by admin                                            0.01s  
  ⨯ index forbidden for regular users                                    0.01s  
  ✓ create requires admin                                                0.02s  
  ⨯ create accessible by admin                                           0.20s  
  ✓ store requires admin                                                 0.02s  
  ⨯ store creates user with valid data                                   0.02s  
  ✓ show requires authentication                                         0.02s  
  ✓ show accessible by admin                                             0.03s  
  ✓ edit requires admin                                                  0.03s  
  ✓ update requires admin                                                0.03s  
  ⨯ update modifies user data                                            0.01s  
  ✓ destroy requires admin                                               0.02s  
  ✓ destroy deletes user                                                 0.02s  

   PASS  Tests\Unit\ConversationModelTest
  ✓ conversation status constants                                        0.02s  
  ✓ conversation state constants                                         0.01s  
  ✓ conversation has number                                              0.01s  
  ✓ conversation has subject                                             0.01s  
  ✓ conversation has status                                              0.01s  
  ✓ conversation has mailbox id                                          0.02s  
  ✓ conversation has customer id                                         0.01s  
  ✓ conversation has user id                                             0.02s  
  ✓ conversation has threads count                                       0.02s  
  ✓ conversation has preview                                             0.01s  
  ✓ conversation has last reply at                                       0.01s  
  ✓ conversation has closed at                                           0.01s  
  ✓ is active returns true for active status                             0.02s  
  ✓ is active returns false for non active status                        0.02s  
  ✓ is closed returns true for closed status                             0.02s  
  ✓ is closed returns false for non closed status                        0.02s  
  ✓ cc and bcc cast to json                                              0.02s  
  ✓ imported and has attachments cast to boolean                         0.03s  
  ✓ update folder assigns correct folder for active assigned conversati… 0.02s  
  ✓ update folder assigns correct folder for active unassigned conversa… 0.02s  
  ✓ update folder assigns correct folder for closed conversation         0.02s  
  ✓ update folder assigns correct folder for spam conversation           0.02s  
  ✓ update folder keeps folder when no matching folder exists            0.02s  
  ✓ conversation with null cc and bcc                                    0.02s  
  ✓ conversation with empty arrays for cc and bcc                        0.02s  
  ✓ conversation status pending                                          0.02s  
  ✓ conversation status spam                                             0.02s  
  ✓ conversation with null user id is unassigned                         0.02s  
  ✓ conversation number is integer                                       0.02s  
  ✓ conversation threads count is integer                                0.02s  

   PASS  Tests\Unit\CustomerControllerTest
  ✓ controller can be instantiated                                       0.03s  
  ✓ index method exists                                                  0.01s  
  ✓ show method exists                                                   0.01s  
  ✓ edit method exists                                                   0.01s  
  ✓ update method exists                                                 0.01s  

   PASS  Tests\Unit\CustomerModelTest
  ✓ customer has first name attribute                                    0.02s  
  ✓ customer has last name attribute                                     0.01s  
  ✓ customer has company attribute                                       0.01s  
  ✓ customer has phones attribute                                        0.01s  
  ✓ customer get full name with both names                               0.01s  
  ✓ customer get full name with only first name                          0.01s  
  ✓ customer get full name with only last name                           0.01s  
  ✓ customer has notes attribute                                         0.01s  
  ✓ customer has address attribute                                       0.02s  
  ✓ customer has city attribute                                          0.01s  
  ✓ customer has conversations relationship                              0.02s  
  ✓ customer full name accessor works                                    0.01s  
  ✓ customer full name accessor trims whitespace                         0.01s  
  ✓ customer has emails relationship                                     0.02s  
  ✓ customer get main email returns primary email                        0.02s  
  ✓ customer get main email returns first email if no primary            0.02s  
  ✓ customer get main email returns null when no emails                  0.01s  
  ✓ customer has threads relationship                                    0.01s  
  ✓ customer has channels relationship                                   0.01s  
  ✓ customer get first name returns empty string when null               0.01s  
  ✓ customer get first name returns actual value                         0.01s  
  ✓ customer primary email attribute returns primary email               0.02s  
  ✓ customer primary email attribute returns null when no primary        0.02s  
  ✓ customer casts attributes correctly                                  0.01s  
  ✓ customer fillable includes all expected fields                       0.01s  

   PASS  Tests\Unit\DashboardControllerTest
  ✓ controller can be instantiated                                       0.03s  
  ✓ index method exists                                                  0.01s  

   FAIL  Tests\Unit\EdgeCases\ModelEdgeCasesTest
  ✓ conversation with null subject                                       0.02s  
  ✓ conversation with very long subject                                  0.02s  
  ⨯ customer with null optional fields                                   0.02s  
  ✓ mailbox with minimal configuration                                   0.01s  
  ✓ thread with empty body                                               0.02s  
  ⨯ user with maximum name length                                        0.01s  
  ✓ conversation cascade deletion of threads                             0.02s  
  ⨯ customer unique email constraint                                     0.02s  
  ✓ user unique email constraint                                         0.02s  
  ✓ mailbox with special characters in name                              0.01s  
  ✓ conversation with future created at date                             0.02s  
  ✓ thread with html content in body                                     0.02s  

   PASS  Tests\Unit\EdgeCases\ValidationEdgeCasesTest
  ✓ email validation rejects invalid formats                             0.02s  
  ✓ email validation accepts valid formats                               0.01s  
  ✓ string length validation boundary conditions                         0.01s  
  ✓ numeric validation boundary conditions                               0.02s  
  ✓ required field validation with empty values                          0.01s  
  ✓ nullable field accepts null value                                    0.01s  
  ✓ unique validation with existing email                                0.02s  
  ✓ array validation with empty array                                    0.01s  
  ✓ boolean validation accepts various formats                           0.01s  

   PASS  Tests\Unit\EmailModelEnhancedTest
  ✓ email has customer relationship                                      0.02s  
  ✓ email is primary returns true for type 1                             0.01s  
  ✓ email is primary returns false for type 2                            0.01s  
  ✓ email is secondary returns true for type 2                           0.02s  
  ✓ email is secondary returns false for type 1                          0.01s  
  ✓ email sanitize converts mixed case to lowercase                      0.01s  
  ✓ email sanitize removes trailing dots                                 0.01s  
  ✓ email sanitize removes dots before at symbol                         0.01s  
  ✓ email sanitize preserves dots in local part                          0.01s  
  ✓ email sanitize returns false for missing at symbol                   0.02s  
  ✓ email sanitize returns false for empty string                        0.02s  
  ✓ email sanitize returns false for null                                0.02s  
  ✓ email sanitize accepts valid simple email                            0.02s  
  ✓ email sanitize accepts email with subdomain                          0.02s  
  ✓ email sanitize accepts email with plus sign                          0.01s  
  ✓ email sanitize accepts email with numbers                            0.01s  
  ✓ email sanitize accepts email with hyphen                             0.01s  
  ✓ email sanitize accepts email with underscore                         0.01s  
  ✓ email sanitize returns false for only at symbol                      0.01s  
  ✓ email sanitize returns false for at at start                         0.01s  
  ✓ email sanitize returns false for at at end                           0.01s  
  ✓ email casts attributes correctly                                     0.01s  
  ✓ email fillable includes expected fields                              0.01s  
  ✓ email can be created with factory                                    0.01s  
  ✓ email factory creates primary email by default                       0.01s  
  ✓ email factory can create secondary email                             0.01s  
  ✓ email sanitize handles unicode characters                            0.01s  
  ✓ multiple emails can belong to same customer                          0.01s  

   PASS  Tests\Unit\EmailModelTest
  ✓ email has email attribute                                            0.03s  
  ✓ email has customer id attribute                                      0.01s  
  ✓ email can set all attributes                                         0.01s  

   PASS  Tests\Unit\EventBroadcastingEnhancedTest
  ✓ new message received has correct properties                          0.02s  
  ✓ new message received broadcast as returns correct name               0.01s  
  ✓ new message received broadcast with contains thread data             0.01s  
  ✓ new message received broadcast with truncates long preview           0.01s  
  ✓ conversation updated broadcast as returns correct name               0.02s  
  ✓ conversation updated broadcast with contains conversation data       0.01s  
  ✓ user viewing conversation broadcast as returns correct name          0.01s  
  ✓ user viewing conversation broadcast with contains user data          0.01s  
  ✓ user viewing conversation broadcasts on presence channel             0.01s  

   PASS  Tests\Unit\EventBroadcastingTest
  ✓ customer created conversation event dispatched                       0.03s  
  ✓ customer replied event dispatched                                    0.02s  
  ✓ new message received event dispatched                                0.02s  
  ✓ event contains correct conversation data                             0.02s  
  ✓ event contains correct thread data                                   0.02s  
  ✓ multiple events can be dispatched                                    0.02s  
  ✓ event not dispatched when not triggered                              0.03s  
  ✓ event listeners are registered                                       0.01s  
  ✓ customer created conversation event properties                       0.02s  
  ✓ customer replied event properties                                    0.02s  
  ✓ new message received event properties                                0.02s  
  ✓ events can be serialized                                             0.03s  

   FAIL  Tests\Unit\Events\EventEdgeCasesTest
  ⨯ new message received event with null preview                         0.03s  
  ⨯ new message received event with very long body                       0.02s  
  ✓ conversation updated event with minimal data                         0.02s  
  ⨯ user viewing conversation with unassigned conversation               0.02s  
  ⨯ event listeners are registered                                       0.02s  
  ⨯ events can be serialized                                             0.02s  
  ⨯ multiple events can be dispatched simultaneously                     0.03s  
  ⨯ event broadcast data is array                                        0.02s  

   PASS  Tests\Unit\EventsTest
  ✓ conversation updated event has conversation                          0.02s  
  ✓ conversation updated broadcasts on correct channel                   0.01s  
  ✓ customer created conversation event has properties                   0.01s  
  ✓ customer replied event has thread                                    0.01s  
  ✓ new message received event has properties                            0.01s  
  ✓ user viewing conversation event has conversation and user ids        0.01s  
  ✓ user viewing conversation broadcasts on correct channel              0.01s  

   PASS  Tests\Unit\FolderEdgeCasesTest
  ✓ deleting mailbox affects folders                                     0.02s  
  ✓ folder type constants are consistent                                 0.01s  
  ✓ folder can have zero conversations                                   0.02s  
  ✓ folder counters can be updated                                       0.02s  
  ✓ folder name is optional for system folders                           0.01s  
  ✓ personal folder type can have user                                   0.02s  
  ✓ multiple users can have personal folders in same mailbox             0.02s  
  ✓ all folder type helper methods work                                  0.02s  
  ✓ folder can store metadata                                            0.01s  
  ✓ starred folder type exists                                           0.01s  
  ✓ assigned folder type exists                                          0.02s  

   PASS  Tests\Unit\FolderHierarchyTest
  ✓ folder type helper methods                                           0.03s  
  ✓ folders belong to correct mailbox                                    0.02s  
  ✓ folders can belong to user                                           0.02s  
  ✓ system folders have no user                                          0.01s  
  ✓ folder counters are tracked                                          0.01s  
  ✓ folders can have conversations via pivot                             0.01s  
  ✓ mailbox can have multiple folder types                               0.02s  

   PASS  Tests\Unit\FolderModelTest
  ✓ folder type constants are defined                                    0.02s  
  ✓ folder belongs to mailbox                                            0.01s  
  ✓ folder can be inbox type                                             0.01s  

   PASS  Tests\Unit\HandleNewMessageListenerTest
  ✓ listener can be instantiated                                         0.02s  
  ✓ listener has handle method                                           0.02s  
  ✓ listener accepts new message received event                          0.02s  
  ✓ listener constructor no parameters                                   0.02s  
  ✓ listener class exists                                                0.01s  
  ✓ handle method signature                                              0.01s  
  ✓ listener processes multiple events                                   0.04s  
  ✓ listener handles event gracefully                                    0.02s  
  ✓ listener handles different thread types                              0.03s  
  ✓ listener handles rapid successive events                             0.05s  
  ✓ listener is stateless                                                0.03s  
  ✓ listener can be instantiated multiple times                          0.01s  
  ✓ listener handles events from different mailboxes                     0.04s  

   PASS  Tests\Unit\ImapServiceAdvancedTest
  ✓ handles missing imap server configuration                            0.04s  
  ✓ handles invalid imap hostname                                        0.02s  
  ✓ handles blank username                                               0.02s  
  ✓ handles blank password                                               0.02s  
  ✓ handles invalid port number                                          0.02s  
  ✓ handles nonexistent imap folder                                      0.02s  
  ✓ handles multiple imap folders                                        0.02s  
  ✓ return structure is always consistent                                0.02s  
  ✓ service never throws exceptions                                      0.02s  
  ✓ handles different encryption types                                   0.02s  
  ✓ handles different protocol types                                     0.02s  
  ✓ statistics are properly initialized                                  0.02s  
  ✓ logs connection attempts                                             0.02s  

   PASS  Tests\Unit\ImapServiceTest
  ✓ fetch emails returns array with no server                            0.03s  
  ✓ fetch emails method exists                                           0.02s  

   FAIL  Tests\Unit\Jobs\SendAutoReplyComprehensiveTest
  ✓ job stores conversation correctly                                    0.05s  
  ⨯ job stores thread correctly                                          0.02s  
  ✓ job stores mailbox correctly                                         0.03s  
  ⨯ job stores customer correctly                                        0.02s  
  ✓ job can be dispatched to queue                                       0.03s  
  ✓ job has public conversation property                                 0.02s  
  ✓ job has public thread property                                       0.02s  
  ✓ job has public mailbox property                                      0.03s  
  ✓ job has public customer property                                     0.03s  

   PASS  Tests\Unit\Jobs\SendAutoReplyTest
  ✓ job can be instantiated                                              0.04s  
  ✓ job has handle method                                                0.01s  
  ✓ job requires conversation thread mailbox and customer                0.03s  

   FAIL  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest
  ⨯ job stores conversation correctly                                    0.03s  
  ⨯ job stores thread correctly                                          0.02s  
  ⨯ job stores user correctly                                            0.03s  
  ✓ job can be dispatched to queue                                       0.03s  
  ⨯ job has public conversation property                                 0.02s  
  ⨯ job has public thread property                                       0.02s  
  ⨯ job has public user property                                         0.02s  
  ⨯ job requires all three parameters                                    0.04s  
  ⨯ job thread belongs to conversation                                   0.03s  

   PASS  Tests\Unit\Jobs\SendConversationReplyTest
  ✓ job can be instantiated                                              0.03s  
  ✓ job has handle method                                                0.01s  
  ✓ job requires conversation thread and email                           0.02s  

   PASS  Tests\Unit\Mail\AutoReplyEnhancedTest
  ✓ auto reply content returns text view                                 0.03s  
  ✓ auto reply content uses default message when none set                0.01s  
  ✓ auto reply content uses custom message when set                      0.01s  
  ✓ auto reply envelope uses default subject when none set               0.02s  
  ✓ auto reply envelope uses custom subject when set                     0.01s  
  ✓ auto reply build returns mailable                                    0.01s  
  ✓ auto reply can be created with headers                               0.02s  
  ✓ auto reply with empty headers array                                  0.01s  

   PASS  Tests\Unit\Mail\ConversationReplyNotificationEnhancedTest
  ✓ conversation reply notification envelope has subject                 0.02s  
  ✓ conversation reply notification envelope has from address            0.01s  
  ✓ conversation reply notification envelope has reply to address        0.01s  
  ✓ conversation reply notification content returns markdown view        0.01s  
  ✓ conversation reply notification content includes conversation        0.01s  
  ✓ conversation reply notification content includes thread              0.01s  
  ✓ conversation reply notification attachments returns empty array      0.01s  
  ✓ conversation reply notification can be instantiated with required p… 0.01s  

   PASS  Tests\Unit\MailHelperTest
  ✓ is auto responder detects x autoreply                                0.03s  
  ✓ is auto responder detects auto submitted                             0.01s  
  ✓ is auto responder detects precedence bulk                            0.01s  
  ✓ is auto responder detects precedence junk                            0.01s  
  ✓ is auto responder detects precedence list                            0.01s  
  ✓ is auto responder detects x autorespond                              0.02s  
  ✓ is auto responder detects x autoresponder                            0.01s  
  ✓ is auto responder returns false for normal email                     0.02s  
  ✓ is auto responder returns false for empty headers                    0.03s  
  ✓ is auto responder returns false for null headers                     0.01s  
  ✓ is auto responder case insensitive                                   0.02s  

   PASS  Tests\Unit\MailTest
  ✓ auto reply has properties                                            0.02s  
  ✓ auto reply envelope has subject                                      0.01s  
  ✓ conversation reply notification has properties                       0.01s  

   PASS  Tests\Unit\MailVarsTest
  ✓ replace mail vars with data set "no vars in string"                  0.02s  
  ✓ replace mail vars with data set "no data"                            0.01s  
  ✓ replace mail vars with data set "invalid variables"                  0.02s  
  ✓ replace mail vars with data set "no data (remove non replaced)"      0.02s  
  ✓ replace mail vars with data set "all data"                           0.02s  
  ✓ replace mail vars with data set "all data with fallbacks"            0.01s  
  ✓ replace mail vars with data set "show all fallbacks"                 0.01s  
  ✓ replace mail vars with data set "all data (escaped)"                 0.02s  
  ✓ replace mail vars with data set "partial data"                       0.02s  
  ✓ replace mail vars with data set "partial data (with removal)"        0.01s  
  ✓ replace mail vars with data set "partial data with fallbacks"        0.02s  
  ✓ has vars                                                             0.01s  
  ✓ simple variable replacement                                          0.01s  
  ✓ fallback values                                                      0.01s  
  ✓ empty fallback removes variable                                      0.01s  
  ✓ html escaping                                                        0.01s  
  ✓ remove non replaced variables                                        0.01s  

   PASS  Tests\Unit\MailboxControllerValidationTest
  ✓ mailbox name is required for creation                                0.03s  
  ✓ mailbox email must be unique                                         0.01s  
  ✓ mailbox email can remain same on update                              0.01s  
  ✓ in port must be integer                                              0.01s  
  ✓ out port must be integer                                             0.01s  
  ✓ in protocol must be valid                                            0.01s  
  ✓ out method must be valid                                             0.01s  
  ✓ in encryption must be valid                                          0.01s  
  ✓ out encryption must be valid                                         0.01s  
  ✓ auto reply enabled must be boolean                                   0.01s  
  ✓ valid mailbox data passes validation                                 0.01s  

   PASS  Tests\Unit\MailboxModelTest
  ✓ mailbox has name                                                     0.02s  
  ✓ mailbox has email                                                    0.01s  
  ✓ mailbox has from name                                                0.01s  
  ✓ mailbox has signature                                                0.01s  
  ✓ mailbox has auto reply enabled                                       0.01s  
  ✓ mailbox has auto reply subject                                       0.01s  
  ✓ mailbox has auto reply message                                       0.01s  
  ✓ mailbox has in server                                                0.01s  
  ✓ mailbox has in port                                                  0.01s  
  ✓ mailbox has out server                                               0.01s  
  ✓ mailbox has out port                                                 0.01s  
  ✓ mailbox has status                                                   0.01s  

   PASS  Tests\Unit\MailboxPolicyTest
  ✓ admin can view any mailboxes                                         0.02s  
  ✓ non admin can view any mailboxes                                     0.01s  
  ✓ admin can create mailbox                                             0.01s  
  ✓ non admin cannot create mailbox                                      0.01s  
  ✓ admin can update mailbox                                             0.01s  
  ✓ non admin cannot update mailbox                                      0.01s  
  ✓ admin can delete mailbox                                             0.01s  
  ✓ non admin cannot delete mailbox                                      0.01s  

   PASS  Tests\Unit\MailboxScopesTest
  ✓ mailboxes can be filtered by user                                    0.02s  
  ✓ admin users have access to all mailboxes                             0.02s  
  ✓ user with no mailboxes returns empty collection                      0.02s  
  ✓ mailboxes can be ordered by name                                     0.01s  

   PASS  Tests\Unit\Middleware\EnsureUserIsAdminTest
  ✓ admin user can pass through middleware                               0.02s  
  ✓ non admin user is blocked                                            0.01s  
  ✓ guest user is blocked                                                0.01s  
  ✓ middleware passes request to next handler                            0.01s  
  ✓ middleware validates user role strictly                              0.01s  

   PASS  Tests\Unit\ModelRelationshipsTest
  ✓ conversation belongs to mailbox                                      0.02s  
  ✓ conversation belongs to customer                                     0.02s  
  ✓ conversation has many threads                                        0.02s  
  ✓ thread belongs to conversation                                       0.02s  
  ✓ mailbox has many conversations                                       0.02s  
  ✓ mailbox has many folders                                             0.01s  
  ✓ mailbox users many to many                                           0.02s  
  ✓ user belongs to many mailboxes                                       0.01s  
  ✓ eager loading prevents n plus 1 on conversations                     0.05s  
  ✓ eager loading multiple relations                                     0.03s  
  ✓ conversation can be assigned to user                                 0.02s  
  ✓ conversation can be unassigned                                       0.01s  
  ✓ empty relationships return empty collections                         0.02s  
  ✓ mailbox user pivot data                                              0.01s  
  ✓ conversation belongs to folder                                       0.02s  
  ✓ folder has many conversations                                        0.02s  
  ✓ thread can belong to user                                            0.02s  
  ✓ thread can belong to customer                                        0.02s  
  ✓ mailbox deletion cascades to conversations                           0.02s  
  ✓ conversation deletion cascades to threads                            0.02s  
  ✓ conversation followers relationship                                  0.02s  
  ✓ conversation belongs to many folders                                 0.02s  
  ✓ conversation created by user relationship                            0.02s  
  ✓ conversation closed by user relationship                             0.02s  
  ✓ mailbox active conversations query                                   0.02s  
  ✓ eager loading with counts                                            0.02s  
  ✓ thread has many attachments relationship                             0.02s  
  ✓ nested eager loading                                                 0.02s  
  ✓ conversation with null user relationship                             0.02s  
  ✓ conversation with null closed by user                                0.02s  
  ✓ activity log subject polymorphic with different models               0.02s  
  ✓ mailbox users detach                                                 0.01s  
  ✓ mailbox users sync                                                   0.02s  
  ✓ orphaned threads handling                                            0.02s  
  ✓ relationship counting without loading                                0.03s  
  ✓ relationship existence queries                                       0.02s  
  ✓ relationship where has queries                                       0.03s  

   PASS  Tests\Unit\Models\ConversationRelationshipsTest
  ✓ conversation belongs to mailbox                                      0.04s  
  ✓ conversation belongs to customer                                     0.02s  
  ✓ conversation belongs to user                                         0.02s  
  ✓ conversation has many threads                                        0.02s  
  ✓ conversation can have no assigned user                               0.02s  
  ✓ conversation scope active filters correctly                          0.02s  
  ✓ conversation scope unassigned filters correctly                      0.02s  
  ✓ conversation eager loads relationships                               0.02s  

   FAIL  Tests\Unit\Models\CustomerComprehensiveTest
  ✓ customer can be instantiated                                         0.02s  
  ✓ customer has conversations relationship                              0.01s  
  ✓ customer has emails relationship                                     0.01s  
  ✓ customer full name concatenates first and last name                  0.01s  
  ✓ customer full name handles null last name                            0.01s  
  ⨯ customer email is unique                                             0.01s  
  ✓ customer can have multiple conversations                             0.03s  
  ✓ customer can have multiple emails                                    0.01s  
  ⨯ customer optional fields can be null                                 0.01s  
  ✓ customer timestamps are set                                          0.01s  
  ⨯ customer can be soft deleted                                         0.01s  
  ⨯ customer phone accepts various formats                               0.01s  
  ⨯ customer first name is required                                      0.01s  
  ⨯ customer email is required                                           0.01s  
  ✓ customer handles very long names                                     0.01s  
  ✓ customer company field accepts long text                             0.01s  
  ⨯ customer email format is validated at database level                 0.01s  
  ⨯ customer can update without changing email                           0.01s  
  ✓ customer eager loading conversations                                 0.02s  
  ✓ customer with special characters in name                             0.01s  

   PASS  Tests\Unit\Models\FolderEnhancedTest
  ✓ folder belongs to mailbox                                            0.02s  
  ✓ folder can belong to user                                            0.01s  
  ✓ folder has many conversations                                        0.02s  
  ✓ folder can be system folder                                          0.01s  
  ✓ folder can be user specific                                          0.01s  
  ✓ folder eager loads relationships                                     0.02s  

   PASS  Tests\Unit\Models\MailboxEnhancedTest
  ✓ mailbox has many conversations                                       0.03s  
  ✓ mailbox has many folders                                             0.01s  
  ✓ mailbox belongs to many users                                        0.01s  
  ✓ mailbox has in server configuration                                  0.01s  
  ✓ mailbox has out server configuration                                 0.01s  
  ✓ mailbox eager loads relationships                                    0.02s  

   PASS  Tests\Unit\Models\UserRelationshipsTest
  ✓ user has many mailboxes                                              0.02s  
  ✓ user has many conversations                                          0.02s  
  ✓ user is admin returns true for admin role                            0.01s  
  ✓ user is admin returns false for regular user                         0.01s  
  ✓ user can have no mailboxes                                           0.01s  
  ✓ user mailbox relationship is many to many                            0.01s  
  ✓ user can be detached from mailbox                                    0.01s  
  ✓ multiple users can share same mailbox                                0.01s  
  ✓ user eager loads mailboxes relationship                              0.01s  
  ✓ user eager loads conversations relationship                          0.02s  

   PASS  Tests\Unit\ModuleModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes                                        0.01s  
  ✓ active cast to boolean                                               0.01s  
  ✓ description is stored                                                0.01s  
  ✓ is active returns true when active                                   0.01s  
  ✓ is active returns false when inactive                                0.02s  
  ✓ activate sets active to true                                         0.01s  
  ✓ deactivate sets active to false                                      0.01s  
  ✓ activate already active module                                       0.01s  
  ✓ deactivate already inactive module                                   0.01s  
  ✓ module with null description                                         0.01s  
  ✓ module alias is unique                                               0.01s  
  ✓ module version format                                                0.01s  
  ✓ created at and updated at timestamps                                 0.01s  
  ✓ module name and alias relationship                                   0.01s  

   PASS  Tests\Unit\OptionModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes                                        0.01s  
  ✓ option can store key value pairs                                     0.01s  
  ✓ option can retrieve value by name                                    0.01s  
  ✓ option returns default when key not found                            0.01s  
  ✓ option can set value by name                                         0.01s  
  ✓ option can update existing value                                     0.01s  
  ✓ option can delete by name                                            0.01s  
  ✓ option delete returns false when key not found                       0.01s  

   FAIL  Tests\Unit\Policies\AdvancedPolicyTest
  ✓ admin can manage all mailboxes                                       0.02s  
  ✓ user can only view assigned mailboxes                                0.02s  
  ✓ user cannot delete mailboxes                                         0.02s  
  ✓ admin can manage all users                                           0.01s  
  ✓ user cannot manage other users                                       0.01s  
  ✓ user can view own profile                                            0.01s  
  ⨯ guest cannot access any resources                                    0.01s  

   PASS  Tests\Unit\Providers\AppServiceProviderTest
  ✓ service provider can be instantiated                                 0.02s  
  ✓ register method executes without error                               0.01s  
  ✓ boot method executes without error                                   0.01s  
  ✓ service provider is loaded or deferred                               0.01s  

   PASS  Tests\Unit\Requests\LoginRequestTest
  ✓ login request authorization returns true                             0.01s  
  ✓ login request validation rules                                       0.01s  
  ✓ login request validates email format                                 0.01s  
  ✓ login request requires email                                         0.01s  
  ✓ login request requires password                                      0.01s  
  ✓ login request accepts valid credentials                              0.01s  
  ✓ throttle key is generated from email and ip                          0.01s  
  ✓ throttle key lowercases email                                        0.01s  

   PASS  Tests\Unit\Requests\ProfileUpdateRequestTest
  ✓ profile update request validation rules                              0.02s  
  ✓ name is required                                                     0.01s  
  ✓ email is required                                                    0.01s  
  ✓ email must be valid format                                           0.01s  
  ✓ email must be unique except current user                             0.01s  
  ✓ name is split into first and last name                               0.01s  
  ✓ name split handles single name                                       0.02s  
  ✓ name split handles multiple spaces                                   0.01s  
  ✓ first name not overridden if provided                                0.01s  
  ✓ last name can be nullable                                            0.01s  

   PASS  Tests\Unit\SendAutoReplyJobTest
  ✓ job has required properties                                          0.02s  
  ✓ job has timeout property                                             0.01s  
  ✓ handle method exists                                                 0.01s  
  ✓ failed method exists                                                 0.01s  

   PASS  Tests\Unit\SendAutoReplyListenerTest
  ✓ listener handle method exists                                        0.02s  
  ✓ listener has correct check period constant                           0.01s  

   PASS  Tests\Unit\SendConversationReplyJobTest
  ✓ job has required properties                                          0.01s  
  ✓ job implements should queue                                          0.01s  
  ✓ job is dispatchable                                                  0.01s  
  ✓ handle method exists                                                 0.01s  
  ✓ job sends email to recipient                                         0.02s  
  ✓ job sends conversation reply notification                            0.02s  
  ✓ job can be dispatched                                                0.02s  
  ✓ job handles various email formats                                    0.02s  
  ✓ job handles international domains                                    0.02s  
  ✓ job uses queueable trait                                             0.01s  
  ✓ job handles long email addresses                                     0.02s  
  ✓ job properties are public                                            0.01s  
  ✓ multiple jobs can be dispatched                                      0.02s  

   PASS  Tests\Unit\SendLogModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes                                        0.01s  
  ✓ is sent returns true for sent status                                 0.02s  
  ✓ is sent returns false for non sent status                            0.02s  
  ✓ is failed returns true for failed status                             0.02s  
  ✓ is failed returns false for non failed status                        0.02s  
  ✓ mail type field exists                                               0.02s  
  ✓ subject field exists                                                 0.02s  
  ✓ belongs to thread                                                    0.02s  
  ✓ belongs to customer                                                  0.02s  
  ✓ belongs to user                                                      0.02s  
  ✓ send log with null customer id                                       0.02s  
  ✓ send log with null user id                                           0.02s  
  ✓ send log with null status message                                    0.02s  
  ✓ send log with status message                                         0.02s  
  ✓ send log mail type values                                            0.03s  
  ✓ send log status values                                               0.03s  
  ✓ send log with smtp queue id                                          0.02s  
  ✓ send log with null smtp queue id                                     0.02s  
  ✓ multiple send logs for same thread                                   0.02s  
  ✓ created at and updated at timestamps                                 0.02s  

   PASS  Tests\Unit\Services\ImapServiceComprehensiveTest
  ✓ fetch emails returns stats array with required keys                  0.10s  
  ✓ fetch emails skips when no imap server configured                    0.01s  
  ✓ fetch emails logs start with correct parameters                      0.09s  
  ✓ fetch emails initializes stats with zeros                            0.01s  
  ✓ fetch emails handles empty in server gracefully                      0.01s  
  ✓ test connection method exists                                        0.01s  
  ✓ create client method exists                                          0.01s  

   PASS  Tests\Unit\Services\ImapServiceTest
  ✓ service can be instantiated                                          0.01s  
  ✓ service has fetch emails method                                      0.01s  
  ✓ service has test connection method                                   0.01s  

   PASS  Tests\Unit\Services\SmtpServiceComprehensiveTest
  ✓ test connection returns result array with required keys              0.10s  
  ✓ test connection validates mailbox settings before sending            0.01s  
  ✓ test connection logs start with correct parameters                   0.07s  
  ✓ configure smtp method exists and is callable                         0.01s  
  ✓ validate settings method exists                                      0.01s  
  ✓ get encryption method exists                                         0.01s  
  ✓ validate mailbox settings method exists                              0.01s  
  ✓ test connection requires valid email address                         0.07s  

   PASS  Tests\Unit\Services\SmtpServiceTest
  ✓ service can be instantiated                                          0.01s  
  ✓ service has test connection method                                   0.01s  
  ✓ service has configure smtp method                                    0.01s  
  ✓ service has validate settings method                                 0.01s  

   PASS  Tests\Unit\SettingsControllerTest
  ✓ controller can be instantiated                                       0.02s  
  ✓ index method exists                                                  0.01s  
  ✓ update method exists                                                 0.01s  
  ✓ email method exists                                                  0.01s  
  ✓ settings controller validates company name                           0.01s  
  ✓ settings controller validates next ticket number                     0.01s  
  ✓ settings controller validates email driver                           0.01s  
  ✓ settings controller validates email address format                   0.01s  
  ✓ settings controller validates mail port is integer                   0.01s  
  ✓ settings controller validates encryption type                        0.01s  

   PASS  Tests\Unit\SmtpServiceTest
  ✓ test connection returns array                                        0.02s  
  ✓ test connection method exists                                        0.01s  
  ✓ configure smtp method exists                                         0.01s  

   PASS  Tests\Unit\SubscriptionModelTest
  ✓ model can be instantiated                                            0.02s  
  ✓ model has fillable attributes                                        0.01s  
  ✓ is email returns true for email medium                               0.01s  
  ✓ is email returns false for non email medium                          0.01s  
  ✓ is browser returns true for browser medium                           0.01s  
  ✓ is browser returns false for non browser medium                      0.01s  
  ✓ is mobile returns true for mobile medium                             0.01s  
  ✓ is mobile returns false for non mobile medium                        0.02s  
  ✓ belongs to user                                                      0.01s  
  ✓ medium and event cast to integer                                     0.01s  
  ✓ subscription medium edge case values                                 0.02s  
  ✓ subscription with various event values                               0.01s  
  ✓ multiple subscriptions for same user                                 0.01s  
  ✓ created at and updated at timestamps                                 0.01s  

   PASS  Tests\Unit\ThreadModelTest
  ✓ thread has conversation id                                           0.02s  
  ✓ thread has user id                                                   0.01s  
  ✓ thread has customer id                                               0.01s  
  ✓ thread has type                                                      0.01s  
  ✓ thread has body                                                      0.01s  
  ✓ thread has from                                                      0.01s  
  ✓ thread has to                                                        0.01s  
  ✓ thread has cc                                                        0.01s  
  ✓ thread has bcc                                                       0.01s  
  ✓ thread has headers                                                   0.01s  
  ✓ is customer message returns true for customer type                   0.02s  
  ✓ is customer message returns false for non customer type              0.03s  
  ✓ is user message returns true for user type                           0.02s  
  ✓ is user message returns false for non user type                      0.02s  
  ✓ is note returns true for note type                                   0.02s  
  ✓ is note returns false for non note type                              0.03s  
  ✓ to cc bcc cast to json                                               0.02s  
  ✓ meta cast to array                                                   0.02s  
  ✓ belongs to conversation                                              0.02s  
  ✓ belongs to created by user                                           0.02s  
  ✓ belongs to edited by user                                            0.02s  
  ✓ has many attachments                                                 0.03s  
  ✓ is bounce returns false when no bounce in meta                       0.02s  
  ✓ is bounce returns true when bounce in meta                           0.02s  
  ✓ is bounce returns false when bounce is false in meta                 0.02s  
  ✓ is bounce handles null meta                                          0.02s  
  ✓ thread with null opened at                                           0.02s  
  ✓ thread with opened at datetime                                       0.02s  
  ✓ thread type constants                                                0.03s  
  ✓ thread with null customer id                                         0.03s  
  ✓ thread with null user id                                             0.02s  
  ✓ thread meta with nested arrays                                       0.02s  
  ✓ thread first flag cast to boolean                                    0.04s  
  ✓ thread has attachments flag cast to boolean                          0.05s  
  ✓ thread with empty to cc bcc arrays                                   0.02s  

   PASS  Tests\Unit\ThreadObserverTest
  ✓ created increments thread count when conversation exists             0.04s  
  ✓ created handles missing conversation                                 0.01s  
  ✓ deleted decrements thread count when conversation exists             0.01s  
  ✓ deleted handles missing conversation                                 0.01s  

   PASS  Tests\Unit\UserModelBatch1Test
  ✓ user has is admin method                                             0.01s  
  ✓ user has is active method                                            0.01s  
  ✓ user has get full name method                                        0.01s  
  ✓ user get full name returns email when name empty                     0.01s  
  ✓ user has full name accessor                                          0.01s  
  ✓ user has name attribute accessor                                     0.01s  
  ✓ user has mailboxes relationship                                      0.01s  
  ✓ user has conversations relationship                                  0.02s  
  ✓ user has folders relationship                                        0.01s  
  ✓ user has followed conversations relationship                         0.01s  
  ✓ user has threads relationship                                        0.01s  
  ✓ user has subscriptions relationship                                  0.01s  
  ✓ user password is automatically hashed                                0.01s  
  ✓ user role constants are defined                                      0.01s  
  ✓ user status constants are defined                                    0.01s  

   PASS  Tests\Unit\UserModelTest
  ✓ user is admin returns true for admin role                            0.03s  
  ✓ user is admin returns false for regular user                         0.01s  
  ✓ user is active returns true for active status                        0.02s  
  ✓ user is active returns false for inactive status                     0.01s  
  ✓ user get full name returns first and last name                       0.02s  
  ✓ user get full name returns email when no name                        0.01s  
  ✓ user name accessor returns full name                                 0.01s  
  ✓ user has mailboxes relationship                                      0.01s  
  ✓ user has conversations relationship                                  0.02s  

   PASS  Tests\Unit\UserPolicyTest
  ✓ admin can view any users                                             0.02s  
  ✓ non admin cannot view any users                                      0.01s  
  ✓ admin can create user                                                0.01s  
  ✓ non admin cannot create user                                         0.01s  
  ✓ admin can update user                                                0.01s  
  ✓ admin can delete other user                                          0.01s  
  ✓ admin cannot delete themselves                                       0.01s  
  ✓ non admin cannot delete user                                         0.01s  

   PASS  Tests\Unit\View\Components\AppLayoutTest
  ✓ app layout can be instantiated                                       0.02s  
  ✓ app layout render returns view                                       0.01s  
  ✓ app layout renders correct view name                                 0.01s  
  ✓ app layout view exists                                               0.01s  
  ✓ app layout component is subclass of component                        0.01s  

   PASS  Tests\Unit\View\Components\GuestLayoutTest
  ✓ guest layout can be instantiated                                     0.02s  
  ✓ guest layout render returns view                                     0.01s  
  ✓ guest layout renders correct view name                               0.01s  
  ✓ guest layout view exists                                             0.01s  
  ✓ guest layout component is subclass of component                      0.01s  

   PASS  Tests\Feature\Auth\AuthenticationTest
  ✓ login screen can be rendered                                         0.03s  
  ✓ users can authenticate using the login screen                        0.02s  
  ✓ users can not authenticate with invalid password                     0.22s  
  ✓ users can logout                                                     0.02s  

   PASS  Tests\Feature\Auth\EmailVerificationNotificationTest
  ✓ email verification notification can be sent                          0.02s  
  ✓ email verification notification not sent if already verified         0.02s  
  ✓ guest cannot request verification notification                       0.02s  

   PASS  Tests\Feature\Auth\EmailVerificationTest
  ✓ email verification screen can be rendered                            0.02s  
  ✓ email can be verified                                                0.02s  
  ✓ email is not verified with invalid hash                              0.02s  

   PASS  Tests\Feature\Auth\PasswordConfirmationTest
  ✓ confirm password screen can be rendered                              0.03s  
  ✓ password can be confirmed                                            0.02s  
  ✓ password is not confirmed with invalid password                      0.22s  

   PASS  Tests\Feature\Auth\PasswordResetTest
  ✓ reset password link screen can be rendered                           0.02s  
  ✓ reset password link can be requested                                 0.22s  
  ✓ reset password screen can be rendered                                0.23s  
  ✓ password can be reset with valid token                               0.22s  

   PASS  Tests\Feature\Auth\PasswordUpdateTest
  ✓ password can be updated                                              0.04s  
  ✓ correct password must be provided to update password                 0.02s  

   PASS  Tests\Feature\Auth\RegistrationTest
  ✓ registration screen can be rendered                                  0.04s  
  ✓ new users can register                                               0.05s  

   PASS  Tests\Feature\AuthenticationBatch1Test
  ✓ guest can view login page                                            0.02s  
  ✓ user can successfully log in with valid credentials                  0.02s  
  ✓ authenticated user can log out                                       0.02s  
  ✓ cannot log in with invalid credentials                               0.22s  
  ✓ cannot log in with nonexistent email                                 0.22s  
  ✓ login requires email                                                 0.02s  
  ✓ login requires password                                              0.02s  

   FAIL  Tests\Feature\Commands\ConfigureGmailMailboxTest
  ✓ command runs successfully with valid inputs                          0.03s  
  ✓ command uses default mailbox id when not provided                    0.03s  
  ✓ command fails with invalid mailbox id                                0.02s  
  ✓ command rejects invalid email address                                0.02s  
  ✓ command rejects empty password                                       0.02s  
  ✓ command displays configuration summary                               0.03s  
  ✓ command shows app password instructions                              0.02s  
  ✓ command shows next steps after configuration                         0.03s  
  ✓ command accepts various email formats                                0.05s  
  ✓ command updates both incoming and outgoing settings                  0.03s  
  ✓ command handles email with special characters                        0.02s  
  ✓ command accepts password with whitespace                             0.03s  
  ⨯ command handles non numeric mailbox id                               0.02s  
  ✓ command preserves mailbox name                                       0.02s  
  ✓ command handles uppercase email address                              0.02s  

   PASS  Tests\Feature\Commands\FetchEmailsCommandTest
  ✓ command fetches emails from specific mailbox                         0.03s  
  ✓ command fetches from all mailboxes when no id specified              0.02s  
  ✓ command test mode only tests connection                              0.02s  
  ✓ command handles connection failure in test mode                      0.02s  
  ✓ command warns when no mailboxes configured                           0.02s  
  ✓ command skips mailboxes without imap server                          0.02s  
  ✓ command handles errors during fetch                                  0.02s  
  ✓ command displays summary statistics                                  0.02s  
  ✓ command handles zero new emails                                      0.02s  
  ✓ command returns zero exit code on success                            0.03s  
  ✓ command with nonexistent mailbox id                                  0.02s  
  ✓ command processes multiple mailboxes in sequence                     0.02s  
  ✓ command handles exception from imap service                          0.02s  
  ✓ command test mode with multiple mailboxes                            0.02s  
  ✓ command skips summary in test mode                                   0.02s  
  ✓ command filters mailboxes with imap configuration                    0.02s  
  ✓ command displays empty line between mailboxes                        0.02s  
  ✓ command test mode with mixed connection results                      0.02s  
  ✓ command handles large number of errors                               0.02s  

   PASS  Tests\Feature\Commands\TestEventSystemTest
  ✓ command fires events with existing conversation                      0.04s  
  ✓ command fails when no conversations exist                            0.02s  
  ✓ command fails when conversation has no threads                       0.02s  
  ✓ command fails when conversation has no customer                      0.03s  
  ✓ command dispatches both events                                       0.03s  
  ✓ command displays customer email                                      0.03s  
  ✓ command uses first conversation with threads                         0.03s  
  ✓ command loads conversation with relationships                        0.03s  
  ✓ command outputs testing message                                      0.03s  
  ✓ command outputs log file location                                    0.03s  
  ✓ command with multiple threads in conversation                        0.03s  
  ✓ command handles invalid customer data gracefully                     0.03s  
  ✓ command fires both event types                                       0.04s  
  ✓ command displays correct conversation id                             0.03s  
  ✓ command displays customer main email                                 0.03s  
  ✓ command works with minimal data setup                                0.03s  
  ✓ command eager loads required relationships                           0.03s  
  ✓ command selects first conversation when multiple exist               0.04s  

   PASS  Tests\Feature\CompleteWorkflowTest
  ✓ full customer inquiry workflow                                       0.07s  
  ✓ auto reply workflow                                                  0.03s  
  ✓ conversation assignment workflow                                     0.04s  
  ✓ multi user collaboration workflow                                    0.05s  
  ✓ email threading workflow                                             0.05s  
  ✓ attachment handling workflow                                         0.04s  
  ✓ user authentication to conversation workflow                         0.07s  
  ✓ settings update affects system behavior                              0.04s  
  ✓ conversation handles deleted customer gracefully                     0.20s  
  ✓ unassigned conversation can be claimed by any agent                  0.04s  
  ✓ reply to closed conversation reopens it                              0.03s  
  ✓ thread can handle multiple attachments                               0.05s  
  ✓ conversation handles concurrent status updates                       0.05s  
  ✓ conversation with empty thread body validation                       0.04s  
  ✓ user loses mailbox access during workflow                            0.05s  
  ✓ conversation list excludes draft conversations                       0.04s  

   FAIL  Tests\Feature\ConversationAdvancedTest
  ✓ conversation index shows only published conversations                0.06s  
  ✓ conversation index orders by most recent                             0.04s  
  ✓ viewing conversation marks notifications as read                     0.04s  
  ✓ conversation show loads threads in order                             0.05s  
  ✓ store creates conversation with new customer                         0.03s  
  ✓ store uses existing customer                                         0.03s  
  ✓ store auto increments conversation number                            0.04s  
  ✓ store rolls back on error                                            0.02s  
  ✓ update changes conversation status                                   0.03s  
  ✓ update reassigns conversation                                        0.03s  
  ✓ update moves conversation to folder                                  0.03s  
  ✓ reply creates thread and updates timestamps                          0.03s  
  ✓ reply can update status to closed                                    0.03s  
  ✓ reply returns json for ajax requests                                 0.03s  
  ✓ reply can create internal note                                       0.03s  
  ⨯ search finds by subject                                              0.19s  
  ⨯ search finds by customer name                                        0.17s  
  ⨯ search only shows authorized mailboxes                               0.19s  
  ⨯ admin search shows all mailboxes                                     0.18s  
  ⨯ search paginates results                                             0.46s  

   WARN  Tests\Feature\ConversationControllerMethodsTest
  ✓ admin can view create conversation form                              0.04s  
  ✓ non admin with mailbox access can view create form                   0.03s  
  ✓ user without mailbox access cannot view create form                  0.03s  
  ✓ guest cannot view create form                                        0.03s  
  ✓ ajax change status updates conversation                              0.04s  
  ✓ ajax change user assigns conversation                                0.03s  
  ✓ ajax change folder moves conversation                                0.03s  
  ✓ ajax delete soft deletes conversation                                0.03s  
  ✓ ajax requires conversation id                                        0.02s  
  ✓ ajax rejects invalid action                                          0.02s  
  ✓ ajax unauthorized user gets forbidden                                0.03s  
  ✓ guest cannot clone conversation                                      0.03s  
  ✓ ajax handles non existent conversation                               0.02s  
  - ajax change status with invalid status value → SQLite does not enfo… 0.02s  
  ✓ ajax change user with null user id                                   0.03s  
  ✓ ajax change folder with non existent folder                          0.03s  
  ✓ ajax with missing action parameter                                   0.03s  
  ✓ ajax handles sql injection attempt                                   0.03s  
  ✓ create form displays user folders only                               0.03s  

   PASS  Tests\Feature\ConversationControllerSecurityTest
  ✓ guest cannot view conversations                                      0.03s  
  ✓ user cannot view unauthorized mailbox conversations                  0.03s  
  ✓ user cannot update conversation in unauthorized mailbox              0.03s  
  ✓ conversation search prevents sql injection                           0.03s  
  ✓ conversation subject sanitizes xss                                   0.03s  
  ✓ conversation creation requires csrf token                            0.02s  
  ✓ user cannot delete unauthorized conversation                         0.03s  
  ✓ admin can access all conversations                                   0.03s  

   PASS  Tests\Feature\ConversationEdgeCasesTest
  ✓ conversation with very long subject is handled                       0.04s  
  ✓ conversation list with many conversations uses pagination            0.17s  
  ✓ conversation with no threads displays correctly                      0.03s  
  ✓ conversation status change validates values                          0.03s  
  ✓ conversation list handles empty mailbox                              0.02s  
  ✓ conversation with special characters in subject is escaped           0.03s  
  ✓ conversation with closed status excludes from active list            0.04s  
  ✓ guest cannot access conversation list                                0.02s  

   PASS  Tests\Feature\ConversationReplyTest
  ✓ user can reply to conversation                                       0.04s  
  ✓ reply validates body is required                                     0.03s  
  ✓ reply can change conversation status                                 0.03s  
  ✓ reply assigns conversation to replying user                          0.03s  
  ✓ unauthorized user cannot reply to conversation                       0.03s  
  ✓ guest cannot reply to conversation                                   0.03s  
  ✓ reply updates conversation timestamp                                 1.03s  
  ✓ conversation update changes status                                   0.02s  
  ✓ conversation update assigns user                                     0.02s  
  ✓ unauthorized user cannot update conversation                         0.02s  

   PASS  Tests\Feature\ConversationTest
  ✓ user can view conversations list                                     0.04s  
  ✓ user can create conversation                                         0.02s  
  ✓ user can view conversation                                           0.03s  
  ✓ user can reply to conversation                                       0.03s  
  ✓ user can update conversation status                                  0.02s  
  ✓ user can assign conversation                                         0.02s  
  ✓ user cannot view conversation in unauthorized mailbox                0.02s  
  ✓ conversation increments thread count                                 0.02s  
  ✓ closed conversation shows correct badge                              0.03s  

   PASS  Tests\Feature\ConversationValidationTest
  ✓ conversation requires subject                                        0.02s  
  ✓ conversation requires body                                           0.02s  
  ✓ conversation validates email format                                  0.02s  
  ✓ conversation subject has reasonable length                           0.02s  
  ✓ conversation body rejects only whitespace                            0.02s  
  ✓ conversation accepts multiple recipients                             0.02s  
  ✓ conversation handles cc and bcc                                      0.02s  
  ✓ conversation rejects invalid customer id                             0.02s  
  ✓ conversation handles special characters in subject                   0.02s  
  ✓ conversation requires at least one recipient                         0.02s  

   PASS  Tests\Feature\CustomerAjaxTest
  ✓ ajax search returns matching customers by first name                 0.03s  
  ✓ ajax search returns matching customers by last name                  0.02s  
  ✓ ajax search limits results to 25                                     0.04s  
  ✓ ajax conversations returns customer conversations                    0.03s  
  ✓ ajax conversations orders by last reply at desc                      0.03s  
  ✓ ajax conversations limits to 50 results                              0.32s  
  ✓ ajax returns error for invalid action                                0.02s  
  ✓ ajax requires authentication                                         0.01s  
  ✓ ajax search returns empty array when no matches                      0.02s  
  ✓ ajax search returns customer with email                              0.02s  
  ✓ ajax conversations returns empty array for customer with no convers… 0.02s  

   PASS  Tests\Feature\CustomerEdgeCasesTest
  ✓ customer with very long name is handled                              0.03s  
  ✓ customer list displays with many records                             0.05s  
  ✓ customer with special characters in name is escaped                  0.02s  
  ✓ customer with null optional fields displays correctly                0.02s  
  ✓ customer list handles no customers                                   0.02s  
  ✓ guest cannot access customer list                                    0.01s  
  ✓ guest cannot view customer detail                                    0.01s  
  ✓ non existent customer returns 404                                    0.01s  

   PASS  Tests\Feature\CustomerManagementTest
  ✓ user can view list of customers                                      0.03s  
  ✓ user can view single customer and conversation history               0.03s  
  ✓ user can update customer details                                     0.02s  
  ✓ cannot create customer with duplicate email if meant to be unique    0.02s  
  ✓ merging two customers reassigns all conversations                    0.03s  
  ✓ unauthenticated user cannot access customers list                    0.02s  
  ✓ unauthenticated user cannot view customer details                    0.02s  
  ✓ unauthenticated user cannot update customer                          0.01s  
  ✓ cannot update customer with invalid email format                     0.02s  
  ✓ cannot merge customer with same id                                   0.02s  
  ✓ cannot merge with non existent customer                              0.02s  
  ✓ user can search customers                                            0.02s  
  ✓ user can access customer edit page                                   0.02s  
  ✓ unauthenticated user cannot access customer edit page                0.01s  
  ✓ updating customer with empty optional fields works                   0.02s  
  ✓ cannot update customer without first name                            0.02s  
  ✓ can update customer with valid country code                          0.02s  
  ✓ merge fails with missing source id                                   0.01s  
  ✓ merge fails with missing target id                                   0.02s  
  ✓ customer list is paginated                                           0.08s  
  ✓ customer show page loads conversations                               0.02s  
  ✓ updating customer with social profiles works                         0.02s  
  ✓ updating customer with websites works                                0.02s  

   PASS  Tests\Feature\CustomerRegressionTest
  ✓ customer identification from incoming email creates new customer     0.03s  
  ✓ customer identification from incoming email finds existing customer  0.02s  
  ✓ customer create sanitizes email address                              0.01s  
  ✓ customer create returns null for invalid email                       0.01s  
  ✓ customer create handles email with trailing dots                     0.01s  
  ✓ customer set data fills empty fields only                            0.01s  
  ✓ customer set data replaces all fields when replace data is true      0.01s  
  ✓ customer set data uses background as notes if notes empty            0.01s  
  ✓ customer set data does not set last name if first name exists        0.01s  
  ✓ customer set data does not set first name if last name exists        0.01s  
  ✓ email sanitize removes dot before at symbol                          0.02s  
  ✓ email sanitize converts to lowercase                                 0.02s  
  ✓ email sanitize returns false for invalid format                      0.01s  
  ✓ customer create handles multiple emails in data                      0.02s  
  ✓ customer set data does not set photo url                             0.02s  
  ✓ customer set data returns false when no changes                      0.02s  
  ✓ customer create associates email with customer                       0.02s  
  ✓ customer create reuses existing email object                         0.02s  
  ✓ email sanitize handles null input                                    0.01s  
  ✓ customer set data with array values are ignored when replace true    0.02s  
  ✓ customer create handles empty data array                             0.02s  
  ✓ email sanitize removes multiple trailing dots                        0.02s  
  ✓ customer set data saves when save parameter is true                  1.02s  
  ✓ customer set data does not save when save parameter is false         0.01s  

   PASS  Tests\Feature\DashboardTest
  ✓ admin can view dashboard with all mailboxes                          0.03s  
  ✓ user can view dashboard with assigned mailboxes only                 0.02s  
  ✓ dashboard displays active conversations count                        0.04s  
  ✓ dashboard displays unassigned conversations count                    0.03s  
  ✓ dashboard provides per mailbox statistics                            0.04s  
  ✓ dashboard only counts published conversations                        0.03s  
  ✓ dashboard requires authentication                                    0.02s  
  ✓ dashboard with no conversations shows zero counts                    0.03s  
  ✓ dashboard handles user with no mailboxes                             0.02s  
  ✓ dashboard stats exclude closed conversations                         0.04s  

   PASS  Tests\Feature\ErrorHandlingTest
  ✓ non existent conversation returns 404                                0.03s  
  ✓ non existent customer returns 404                                    0.01s  
  ✓ guest access to protected customer route redirects to login          0.01s  
  ✓ unauthorized mailbox conversation access is prevented                0.02s  
  ✓ invalid email format in customer creation validates                  0.01s  
  ✓ empty required customer field returns validation error               0.01s  
  ✓ ajax search with empty query handled gracefully                      0.01s  
  ✓ sql injection attempt in customer search handled safely              0.01s  
  ✓ xss attempt in customer name is escaped                              0.02s  
  ✓ accessing conversation in deleted mailbox returns 404                0.02s  
  ✓ very long search query handled without error                         0.02s  
  ✓ concurrent conversation reply attempts handled                       0.03s  

   PASS  Tests\Feature\ExampleTest
  ✓ the application returns a successful response                        0.02s  

   PASS  Tests\Feature\Integration\ConversationWorkflowTest
  ✓ complete conversation workflow from creation to closure              0.03s  
  ✓ conversation reassignment workflow                                   0.03s  
  ✓ conversation with multiple threads                                   0.02s  
  ✓ conversation status transitions                                      0.02s  

   PASS  Tests\Feature\MailboxAutoReplyTest
  ✓ admin can view auto reply settings page                              0.03s  
  ✓ non admin cannot view auto reply settings page                       0.02s  
  ✓ admin can enable auto reply with required fields                     0.02s  
  ✓ admin can disable auto reply                                         0.02s  
  ✓ auto reply requires subject when enabled                             0.02s  
  ✓ auto reply requires message when enabled                             0.02s  
  ✓ auto reply subject has max length                                    0.02s  
  ✓ auto reply can include auto bcc email                                0.02s  
  ✓ auto bcc must be valid email                                         0.02s  
  ✓ non admin cannot save auto reply settings                            0.02s  

   PASS  Tests\Feature\MailboxCRUDTest
  ✓ admin can create mailbox                                             0.02s  
  ✓ non admin cannot create mailbox                                      0.02s  
  ✓ mailbox creation validates email format                              0.02s  
  ✓ mailbox creation requires unique email                               0.02s  
  ✓ admin can update mailbox                                             0.02s  
  ✓ non admin cannot update mailbox                                      0.02s  
  ✓ mailbox update validates data                                        0.02s  
  ✓ admin can delete mailbox                                             0.02s  
  ✓ non admin cannot delete mailbox                                      0.02s  
  ✓ guest cannot access mailbox crud operations                          0.02s  
  ✓ mailbox creation with optional fields                                0.02s  

   PASS  Tests\Feature\MailboxConnectionTest
  ✓ non admins cannot view connection settings pages                     0.03s  
  ✓ non admins cannot update connection settings                         0.02s  
  ✓ admin can view incoming connection settings page                     0.04s  
  ✓ admin can update incoming connection settings                        0.02s  
  ✓ incoming connection validation fails with invalid data               0.02s  
  ✓ admin can view outgoing connection settings page                     0.04s  
  ✓ admin can update outgoing connection settings                        0.02s  
  ✓ outgoing connection validation fails with invalid data               0.02s  

   PASS  Tests\Feature\MailboxFetchEmailsTest
  ✓ admin can trigger manual email fetch                                 0.02s  
  ✓ non admin cannot trigger manual email fetch                          0.02s  
  ✓ fetch emails returns error on imap failure                           0.02s  
  ✓ unauthenticated user cannot trigger email fetch                      0.01s  
  ✓ fetch emails with zero new emails                                    0.02s  

   PASS  Tests\Feature\MailboxPermissionsTest
  ✓ admin can view permissions page                                      0.02s  
  ✓ non admin cannot view permissions page                               0.02s  
  ✓ admin can update permissions                                         0.02s  
  ✓ user with view access can view mailbox                               0.03s  
  ✓ user without view access cannot view mailbox                         0.02s  
  ✓ user with reply access can reply                                     0.02s  
  ✓ user with view access cannot reply                                   0.02s  
  ✓ user with admin access can update mailbox settings                   0.02s  
  ✓ user with reply access cannot update mailbox settings                0.01s  

   PASS  Tests\Feature\MailboxRegressionTest
  ✓ mailbox permission logic matches l5 version                          0.04s  
  ✓ mailbox user pivot maintains l5 compatibility                        0.01s  
  ✓ folder structure matches l5 version                                  0.01s  
  ✓ conversation folder relationship matches l5                          0.01s  
  ✓ mailbox passwords are encrypted                                      0.02s  
  ✓ mailbox get mail from matches l5 behavior                            0.01s  
  ✓ mailbox uses custom from name when set                               0.01s  
  ✓ mailbox uses mailbox name as fallback                                0.01s  

   PASS  Tests\Feature\MailboxTest
  ✓ admin can view mailboxes list                                        0.03s  
  ✓ admin can create mailbox                                             0.02s  
  ✓ admin can update mailbox                                             0.02s  
  ✓ admin can delete mailbox                                             0.02s  
  ✓ non admin cannot create mailbox                                      0.02s  
  ✓ mailbox requires unique email                                        0.02s  
  ✓ mailbox can have users attached                                      0.01s  
  ✓ mailbox auto reply settings                                          0.02s  

   PASS  Tests\Feature\MailboxViewTest
  ✓ admin can view mailbox detail                                        0.02s  
  ✓ user with access can view mailbox detail                             0.02s  
  ✓ user without access cannot view mailbox detail                       0.02s  
  ✓ unauthenticated user cannot view mailbox detail                      0.02s  
  ✓ admin can view mailbox settings page                                 0.02s  
  ✓ non admin cannot view mailbox settings page                          0.02s  
  ✓ mailbox index shows only accessible mailboxes for user               0.02s  
  ✓ mailbox index shows all mailboxes for admin                          0.02s  
  ✓ mailbox index requires authentication                                0.02s  

   PASS  Tests\Feature\ModulesTest
  ✓ admin can view modules list page                                     0.03s  
  ✓ non admin cannot view modules list                                   0.01s  
  ✓ guest cannot view modules list                                       0.01s  
  ✓ modules list displays module metadata                                0.02s  
  ✓ enable module returns error for non existent module                  0.02s  
  ✓ disable module returns error for non existent module                 0.01s  
  ✓ delete module returns error for non existent module                  0.01s  
  ✓ non admin cannot enable modules                                      0.01s  
  ✓ non admin cannot disable modules                                     0.01s  
  ✓ non admin cannot delete modules                                      0.02s  
  ✓ guest cannot enable modules                                          0.02s  
  ✓ guest cannot disable modules                                         0.01s  
  ✓ guest cannot delete modules                                          0.01s  
  ✓ enable module returns proper json structure                          0.01s  
  ✓ disable module returns proper json structure                         0.01s  
  ✓ modules index requires manage settings permission                    0.02s  
  ✓ module operations require authentication                             0.02s  
  ✓ module list handles empty modules collection                         0.02s  

   PASS  Tests\Feature\OptionRegressionTest
  ✓ option retrieval matches l5 behavior                                 0.02s  
  ✓ option setting matches l5 behavior                                   0.01s  
  ✓ option deletion matches l5 behavior                                  0.01s  
  ✓ settings default values match l5                                     0.01s  
  ✓ settings update flow matches l5                                      0.02s  
  ✓ boolean options stored as integers like l5                           0.01s  
  ✓ update or create behavior matches l5                                 0.01s  

   FAIL  Tests\Feature\PaginationAndFilteringTest
  ✓ conversation list with page 2 navigation                             0.17s  
  ✓ customer ajax search with multiple matching results                  0.04s  
  ⨯ conversation search with partial match                               0.14s  
  ✓ mailbox conversations filter by assignment status                    0.03s  
  ✓ customer list handles large dataset efficiently                      0.10s  
  ✓ empty search query returns all results                               0.03s  
  ✓ conversation list excludes draft conversations by default            0.03s  
"Performance Benchmarks:" // tests/Feature/PerformanceTest.php:378
array:4 [
  "dashboard" => 5.1040649414062
  "conversation_list" => 7.7090263366699
  "conversation_view" => 7.4050426483154
  "reply_creation" => 3.8599967956543
] // tests/Feature/PerformanceTest.php:378

   PASS  Tests\Feature\PerformanceTest
  ✓ large conversation list loads efficiently                            0.23s  
  ✓ search performs efficiently with large dataset                       0.15s  
  ✓ mailbox with many conversations remains responsive                   0.20s  
  ✓ conversation with many threads loads correctly                       0.07s  
  ✓ conversation list avoids n plus one queries                          0.10s  
  ✓ memory usage remains stable during operations                        0.09s  
  ✓ common operations meet response time benchmarks                      0.05s  
  ✓ database queries use indexes effectively                             0.09s  
  ✓ empty conversation list performs efficiently                         0.02s  
  ✓ conversation with maximum threads loads acceptably                   0.25s  
  ✓ search with no results performs efficiently                          0.10s  
  ✓ conversation list with mixed statuses performs well                  0.21s  
  ✓ sequential conversation loads use connection efficiently             0.07s  
  ✓ pagination boundary performs consistently                            0.42s  
  ✓ rapid consecutive operations maintain stability                      0.06s  
  ✓ repeated operations show no memory leaks                             0.14s  

   PASS  Tests\Feature\ProfileTest
  ✓ profile page is displayed                                            0.05s  
  ✓ profile information can be updated                                   0.02s  
  ✓ email verification status is unchanged when the email address is un… 0.02s  
  ✓ user can delete their account                                        0.02s  
  ✓ correct password must be provided to delete account                  0.02s  

   PASS  Tests\Feature\SecurityAndEdgeCasesTest
  ✓ guest cannot access settings routes                                  0.02s  
  ✓ guest cannot access system routes                                    0.02s  
  ✓ non admin cannot update settings                                     0.02s  
  ✓ non admin cannot access email settings                               0.02s  
  ✓ non admin cannot update email settings                               0.01s  
  ✓ non admin cannot clear cache                                         0.01s  
  ✓ non admin cannot run migrations                                      0.01s  
  ✓ non admin cannot access system diagnostics                           0.02s  
  ✓ option handles null values correctly                                 0.01s  
  ✓ option handles empty string values                                   0.01s  
  ✓ option handles numeric values                                        0.01s  
  ✓ option handles array values                                          0.02s  
  ✓ settings validation prevents sql injection                           0.01s  
  ✓ settings validation prevents xss                                     0.02s  
  ✓ email settings require valid email format                            0.02s  
  ✓ email settings require supported driver                              0.02s  
  ✓ system diagnostics checks database connection                        0.02s  
  ✓ system diagnostics checks storage writable                           0.02s  
  ✓ system diagnostics checks cache working                              0.01s  
  ✓ option set value creates new record when not exists                  0.01s  
  ✓ option set value updates existing record                             0.01s  
  ✓ option delete option handles non existent keys gracefully            0.01s  
  ✓ multiple options can be stored and retrieved                         0.01s  
  ✓ settings page displays existing options                              0.02s  
  ✓ system ajax requires admin                                           0.02s  
  ✓ admin can get system info with correct structure                     0.01s  

   PASS  Tests\Feature\SettingsControllerMethodsTest
  ✓ admin can test smtp connection                                       0.04s  
  ✓ test smtp validates required fields                                  0.01s  
  ✓ test smtp validates email format                                     0.02s  
  ✓ test smtp fails when no server configured                            0.02s  
  ✓ test smtp handles service exceptions                                 0.02s  
  ✓ non admin cannot test smtp                                           0.02s  
  ✓ admin can test imap connection                                       0.02s  
  ✓ test imap validates required mailbox id                              0.01s  
  ✓ test imap fails when no server configured                            0.02s  
  ✓ test imap handles service exceptions                                 0.02s  
  ✓ non admin cannot test imap                                           0.02s  
  ✓ guest cannot test smtp                                               0.01s  
  ✓ guest cannot test imap                                               0.01s  
  ✓ test smtp with invalid mailbox id                                    0.01s  
  ✓ test imap with invalid mailbox id                                    0.01s  
  ✓ test smtp with non numeric mailbox id                                0.02s  
  ✓ test smtp service returns failure                                    0.02s  
  ✓ test imap service returns failure                                    0.02s  
  ✓ test smtp with empty server string                                   0.02s  
  ✓ test imap with empty server string                                   0.02s  
  ✓ test smtp with multiple validation errors                            0.02s  
  ✓ test smtp with special characters in email                           0.02s  

   PASS  Tests\Feature\SettingsOperationsTest
  ✓ admin can clear cache                                                0.03s  
  ✓ non admin cannot clear cache                                         0.02s  
  ✓ guest cannot clear cache                                             0.01s  
  ✓ admin can run migrations                                             0.02s  
  ✓ non admin cannot run migrations                                      0.02s  
  ✓ guest cannot run migrations                                          0.01s  
  ✓ cache clear creates activity log                                     0.02s  
  ✓ migration failure is handled gracefully                              0.02s  
  ✓ settings operations require admin role                               0.02s  
  ✓ consecutive cache clears work                                        0.02s  
  ✓ cache clear with active sessions                                     0.02s  

   PASS  Tests\Feature\SettingsTest
  ✓ admin can view main settings page                                    0.04s  
  ✓ admin can update general setting                                     0.02s  
  ✓ admin can view email settings page                                   0.02s  
  ✓ admin can update email settings                                      0.02s  
  ✓ admin can view system settings page                                  0.02s  
  ✓ non admin user cannot access settings routes                         0.02s  
  ✓ submitting invalid data to setting fails validation                  0.02s  
  ✓ submitting invalid driver fails validation                           0.02s  
  ✓ admin can clear cache                                                0.02s  
  ✓ settings update clears cache                                         0.02s  

   PASS  Tests\Feature\SystemTest
  ✓ admin can view system status page                                    0.04s  
  ✓ system status page displays php version                              0.02s  
  ✓ system status page displays laravel version                          0.02s  
  ✓ admin can run system diagnostics                                     0.01s  
  ✓ non admin cannot view system status                                  0.02s  
  ✓ admin can view system logs                                           0.02s  
  ✓ non admin cannot access system logs                                  0.02s  
  ✓ admin can clear cache via ajax                                       0.02s  
  ✓ admin can optimize application via ajax                              0.19s  
  ✓ admin can get system info via ajax                                   0.01s  
  ✓ non admin cannot execute system ajax commands                        0.01s  
  ✓ invalid ajax action returns error                                    0.01s  

   PASS  Tests\Feature\UserControllerMethodsTest
  ✓ non admin cannot view create user form                               0.02s  
  ✓ guest cannot view create user form                                   0.01s  
  ✓ admin can view user details                                          0.01s  
  ✓ user can view own profile                                            0.01s  
  ✓ user cannot view other user profile                                  0.01s  
  ✓ show includes related data                                           0.01s  
  ✓ admin can view edit user form                                        0.01s  
  ✓ user can edit own profile                                            0.01s  
  ✓ user cannot edit other user                                          0.01s  
  ✓ guest cannot view edit user form                                     0.02s  
  ✓ show with non existent user                                          0.01s  
  ✓ edit with non existent user                                          0.01s  
  ✓ show inactive user                                                   0.01s  
  ✓ edit inactive user                                                   0.01s  
  ✓ show with deleted related data                                       0.01s  
  ✓ show user with no mailboxes                                          0.01s  
  ✓ show user with multiple mailboxes                                    0.02s  
  ✓ regular user cannot view admin profile                               0.01s  
  ✓ regular user cannot edit admin profile                               0.01s  
  ✓ show includes conversations relationship                             0.01s  
  ✓ user can view own profile with special characters in name            0.01s  
  ✓ edit form for user with boundary field values                        0.01s  

   PASS  Tests\Feature\UserManagementAdminBatch1Test
  ✓ admin user can create a new user                                     0.02s  
  ✓ admin user can create user with admin role                           0.01s  
  ✓ admin user can update an existing user                               0.01s  
  ✓ admin can change user role                                           0.01s  
  ✓ admin can change user status                                         0.01s  
  ✓ created user password is properly hashed                             0.01s  
  ✓ non admin user cannot access user management routes                  0.01s  
  ✓ non admin user cannot create users                                   0.01s  
  ✓ non admin user cannot update other users                             0.01s  
  ✓ admin can assign user to mailboxes                                   0.01s  

   PASS  Tests\Feature\UserManagementTest
  ✓ admin can view users list                                            0.02s  
  ✓ admin can create user                                                0.01s  
  ✓ admin can update user                                                0.01s  
  ✓ admin can deactivate user                                            0.01s  
  ✓ non admin cannot access users list                                   0.01s  
  ✓ user email must be unique                                            0.02s  
  ✓ user password is hashed                                              0.01s  
  ✓ user can be assigned to mailboxes                                    0.01s  
  ✓ admin cannot delete themselves                                       0.01s  
  ✓ admin can delete other users                                         0.01s  

   PASS  Tests\Feature\UserPermissionsTest
  ✓ admin can assign mailbox permissions to user                         0.02s  
  ✓ admin can remove mailbox permissions from user                       0.01s  
  ✓ admin can remove all mailbox permissions                             0.01s  
  ✓ non admin cannot assign permissions                                  0.01s  
  ✓ guest cannot assign permissions                                      0.01s  
  ✓ permission assignment handles invalid mailbox ids                    0.01s  
  ✓ admin role provides broader access                                   0.01s  

   PASS  Tests\Feature\UserSecurityBatch1Test
  ✓ user email is sanitized against xss                                  0.01s  
  ✓ user name fields handle html tags properly                           0.01s  
  ✓ mass assignment protection prevents role escalation                  0.01s  
  ✓ session is invalidated on logout                                     0.01s  
  ✓ failed login attempts do not reveal user existence                   0.42s  
  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\Auth\RegisteredUserControllerTest > store…    
  Failed asserting that a row in the table [users] matches the attributes {
    "name": "John Doe",
    "email": "john@example.com"
}.

Found: [
    {
        "\"name\"": "name",
        "email": "john@example.com"
    }
].

  at tests/Unit/Controllers/Auth/RegisteredUserControllerTest.php:32
     28▕             'password' => 'password123',
     29▕             'password_confirmation' => 'password123',
     30▕         ]);
     31▕ 
  ➜  32▕         $this->assertDatabaseHas('users', [
     33▕             'name' => 'John Doe',
     34▕             'email' => 'john@example.com',
     35▕         ]);
     36▕     }

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\ProfileControllerTest > up…  QueryException   
  SQLSTATE[HY000]: General error: 1 table users has no column named name (Connection: sqlite, SQL: insert into "users" ("first_name", "last_name", "email", "email_verified_at", "password", "remember_token", "role", "timezone", "photo_url", "type", "status", "invite_state", "locale", "job_title", "phone", "time_format", "enable_kb_shortcuts", "name", "updated_at", "created_at") values (Bethany, Rogahn, old@example.com, 2025-11-09 18:24:58, $2y$04$sEohEO5sG4BrEU2g6v28ze63cKFXJLtwczzAbVR8Km1zNvGD4zraC, DAieptnzeE, 1, UTC, ?, 1, 1, 1, en, Agricultural Equipment Operator, 470-695-0956, 12, 1, Old Name, 2025-11-09 18:24:58, 2025-11-09 18:24:58))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Controllers/ProfileControllerTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\ProfileControllerTest > up…  QueryException   
  SQLSTATE[HY000]: General error: 1 table users has no column named name (Connection: sqlite, SQL: insert into "users" ("first_name", "last_name", "email", "email_verified_at", "password", "remember_token", "role", "timezone", "photo_url", "type", "status", "invite_state", "locale", "job_title", "phone", "time_format", "enable_kb_shortcuts", "name", "updated_at", "created_at") values (Carolina, Vandervort, test@example.com, 2025-11-09 18:24:58, $2y$04$sEohEO5sG4BrEU2g6v28ze63cKFXJLtwczzAbVR8Km1zNvGD4zraC, GiSXLSQawu, 1, America/Chicago, ?, 1, 1, 1, en, Typesetter, 878.286.1203, 12, 1, Test User, 2025-11-09 18:24:58, 2025-11-09 18:24:58))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Controllers/ProfileControllerTest.php:83

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest…  RouteNotFoundException   
  Route [users] not defined.

  at vendor/laravel/framework/src/Illuminate/Routing/UrlGenerator.php:517
    513▕             ! is_null($url = call_user_func($this->missingNamedRouteResolver, $name, $parameters, $absolute))) {
    514▕             return $url;
    515▕         }
    516▕ 
  ➜ 517▕         throw new RouteNotFoundException("Route [{$name}] not defined.");
    518▕     }
    519▕ 
    520▕     /**
    521▕      * Get the URL for a given route instance.

      [2m+2 vendor frames [22m
  3   tests/Unit/Controllers/UserControllerTest.php:26

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest…  RouteNotFoundException   
  Route [users] not defined.

  at vendor/laravel/framework/src/Illuminate/Routing/UrlGenerator.php:517
    513▕             ! is_null($url = call_user_func($this->missingNamedRouteResolver, $name, $parameters, $absolute))) {
    514▕             return $url;
    515▕         }
    516▕ 
  ➜ 517▕         throw new RouteNotFoundException("Route [{$name}] not defined.");
    518▕     }
    519▕ 
    520▕     /**
    521▕      * Get the URL for a given route instance.

      [2m+2 vendor frames [22m
  3   tests/Unit/Controllers/UserControllerTest.php:35

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest…  RouteNotFoundException   
  Route [users] not defined.

  at vendor/laravel/framework/src/Illuminate/Routing/UrlGenerator.php:517
    513▕             ! is_null($url = call_user_func($this->missingNamedRouteResolver, $name, $parameters, $absolute))) {
    514▕             return $url;
    515▕         }
    516▕ 
  ➜ 517▕         throw new RouteNotFoundException("Route [{$name}] not defined.");
    518▕     }
    519▕ 
    520▕     /**
    521▕      * Get the URL for a given route instance.

      [2m+2 vendor frames [22m
  3   tests/Unit/Controllers/UserControllerTest.php:44

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest > create accessible by…    
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

Symfony\Component\Routing\Exception\RouteNotFoundException: Route [users] not defined. in /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/UrlGenerator.php:517
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/helpers.php(853): Illuminate\Routing\UrlGenerator->route()
#1 /var/www/html/storage/framework/views/3a7e1a10c8ff18053a5409a266f79564.php(161): route()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Unit/Controllers/UserControllerTest.php(62): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Unit\Controllers\UserControllerTest->test_create_accessible_by_admin()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: Route [users] not defined. (View: /var/www/html/resources/views/users/create.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/UrlGenerator.php:517
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Unit/Controllers/UserControllerTest.php(62): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Unit\Controllers\UserControllerTest->test_create_accessible_by_admin()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

Route [users] not defined. (View: /var/www/html/resources/views/users/create.blade.php)

  at tests/Unit/Controllers/UserControllerTest.php:64
     60▕         $admin = User::factory()->create(['role' => User::ROLE_ADMIN]);
     61▕ 
     62▕         $response = $this->actingAs($admin)->get(route('users.create'));
     63▕ 
  ➜  64▕         $response->assertStatus(200);
     65▕     }
     66▕ 
     67▕     public function test_store_requires_admin(): void
     68▕     {

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest > store creates user wi…   
  Failed asserting that a row in the table [users] matches the attributes {
    "name": "Test User",
    "email": "testuser@example.com"
}.

Found: [
    {
        "\"name\"": "name",
        "email": "stroman.crawford@example.com"
    }
].

  at tests/Unit/Controllers/UserControllerTest.php:92
     88▕             'password_confirmation' => 'SecurePass123!',
     89▕             'role' => User::ROLE_USER,
     90▕         ]);
     91▕ 
  ➜  92▕         $this->assertDatabaseHas('users', [
     93▕             'name' => 'Test User',
     94▕             'email' => 'testuser@example.com',
     95▕         ]);
     96▕     }

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Controllers\UserControllerTest > updat…  QueryException   
  SQLSTATE[HY000]: General error: 1 table users has no column named name (Connection: sqlite, SQL: insert into "users" ("first_name", "last_name", "email", "email_verified_at", "password", "remember_token", "role", "timezone", "photo_url", "type", "status", "invite_state", "locale", "job_title", "phone", "time_format", "enable_kb_shortcuts", "name", "updated_at", "created_at") values (Samir, Hagenes, zolson@example.com, 2025-11-09 18:24:59, $2y$04$sEohEO5sG4BrEU2g6v28ze63cKFXJLtwczzAbVR8Km1zNvGD4zraC, VV3vLEiJRi, 1, America/Los_Angeles, ?, 1, 1, 1, en, Heating Equipment Operator, 1-351-582-5750, 12, 1, Original Name, 2025-11-09 18:24:59, 2025-11-09 18:24:59))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Controllers/UserControllerTest.php:142

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\EdgeCases\ModelEdgeCasesTest > custome…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (John, ?, ?, ?, ?, 1, 1, ?, [{"type":"work","value":"+1-302-968-2749"}], ?, ?, ?, ?, kj, ?, CG, ?, john@example.com, 2025-11-09 18:25:00, 2025-11-09 18:25:00))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/EdgeCases/ModelEdgeCasesTest.php:37

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\EdgeCases\ModelEdgeCasesTest > user wi…  QueryException   
  SQLSTATE[HY000]: General error: 1 table users has no column named name (Connection: sqlite, SQL: insert into "users" ("first_name", "last_name", "email", "email_verified_at", "password", "remember_token", "role", "timezone", "photo_url", "type", "status", "invite_state", "locale", "job_title", "phone", "time_format", "enable_kb_shortcuts", "name", "updated_at", "created_at") values (Aletha, Hartmann, longname@example.com, 2025-11-09 18:25:00, $2y$04$sEohEO5sG4BrEU2g6v28ze63cKFXJLtwczzAbVR8Km1zNvGD4zraC, Ms6gtOjYcK, 1, America/Los_Angeles, ?, 1, 1, 1, en, Camera Repairer, (970) 572-8506, 12, 1, xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx, 2025-11-09 18:25:00, 2025-11-09 18:25:00))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/EdgeCases/ModelEdgeCasesTest.php:80

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\EdgeCases\ModelEdgeCasesTest > custome…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (Allen, Hegmann, Zboncak, Beer and Weimann, ?, ?, 1, 1, ?, [{"type":"work","value":"+15747447395"}], ?, ?, 235 Carlo Branch, ?, dd, ?, ?, ?, unique@example.com, 2025-11-09 18:25:00, 2025-11-09 18:25:00))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/EdgeCases/ModelEdgeCasesTest.php:104

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > new me…  ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 24 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:24

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > new me…  ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 34 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:34

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > user viewing co…  TypeError   
  App\Events\UserViewingConversation::__construct(): Argument #1 ($conversationId) must be of type int, App\Models\User given, called in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 53

  at app/Events/UserViewingConversation.php:20
     16▕ class UserViewingConversation implements ShouldBroadcast
     17▕ {
     18▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     19▕ 
  ➜  20▕     public function __construct(
     21▕         public int $conversationId,
     22▕         public User $user,
     23▕         public bool $isReplying = false,
     24▕     ) {

  1   app/Events/UserViewingConversation.php:20
  2   tests/Unit/Events/EventEdgeCasesTest.php:53

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > event…   ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 69 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:69

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > events…  ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 77 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:77

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > multip…  ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 93 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:93

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Events\EventEdgeCasesTest > event…   ArgumentCountError   
  Too few arguments to function App\Events\NewMessageReceived::__construct(), 1 passed in /var/www/html/tests/Unit/Events/EventEdgeCasesTest.php on line 105 and exactly 2 expected

  at app/Events/NewMessageReceived.php:22
     18▕ class NewMessageReceived implements ShouldBroadcast
     19▕ {
     20▕     use Dispatchable, InteractsWithSockets, SerializesModels;
     21▕ 
  ➜  22▕     public function __construct(
     23▕         public Thread $thread,
     24▕         public Conversation $conversation,
     25▕     ) {
     26▕     }

  1   app/Events/NewMessageReceived.php:22
  2   tests/Unit/Events/EventEdgeCasesTest.php:105

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendAutoReplyComprehensiveTest > job store…  Error   
  Undefined constant App\Models\Thread::TYPE_CUSTOMER

  at tests/Unit/Jobs/SendAutoReplyComprehensiveTest.php:41
     37▕         $customer = Customer::factory()->create();
     38▕         $conversation = Conversation::factory()->create();
     39▕         $thread = Thread::factory()->create([
     40▕             'conversation_id' => $conversation->id,
  ➜  41▕             'type' => Thread::TYPE_CUSTOMER,
     42▕         ]);
     43▕ 
     44▕         $job = new SendAutoReply($conversation, $thread, $mailbox, $customer);
     45▕

  1   tests/Unit/Jobs/SendAutoReplyComprehensiveTest.php:41

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendAutoReplyComprehensiveTest >…   QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (Tara, Balistreri, Kris, O'Reilly and Brakus, Personal Care Worker, ?, 1, 1, ?, [{"type":"work","value":"623-672-0671"}], [{"value":"http:\/\/www.sanford.com\/ex-consequatur-nemo-dolorem.html"}], ?, ?, North Antoinettetown, io, 05244, IQ, ?, customer@example.com, 2025-11-09 18:25:03, 2025-11-09 18:25:03))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Jobs/SendAutoReplyComprehensiveTest.php:66

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 25

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:25

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 40

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:40

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 52

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:52

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 77

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:77

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 91

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:91

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 105

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:105

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 119

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:119

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Jobs\SendConversationReplyComprehensiveTest…  TypeError   
  App\Jobs\SendConversationReply::__construct(): Argument #3 ($recipientEmail) must be of type string, App\Models\User given, called in /var/www/html/tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php on line 132

  at app/Jobs/SendConversationReply.php:19
     15▕ 
     16▕     /**
     17▕      * Create a new job instance.
     18▕      */
  ➜  19▕     public function __construct(
     20▕         public Conversation $conversation,
     21▕         public Thread $thread,
     22▕         public string $recipientEmail
     23▕     ) {}

  1   app/Jobs/SendConversationReply.php:19
  2   tests/Unit/Jobs/SendConversationReplyComprehensiveTest.php:132

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > cus…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (Isai, Koch, Gusikowski-Rempel, Announcer, ?, 1, 1, ?, ?, ?, ?, ?, Rodriguezton, mn, 29840-2502, ?, ?, unique@example.com, 2025-11-09 18:25:05, 2025-11-09 18:25:05))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Models/CustomerComprehensiveTest.php:54

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > cus…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named phone (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "phone", "updated_at", "created_at") values (Jarret, Weimann, ?, ?, ?, 1, 1, ?, [{"type":"work","value":"(207) 685-9033"}], [{"value":"http:\/\/www.lubowitz.com\/repudiandae-qui-repellendus-consectetur-dicta"}], ?, ?, ?, ?, ?, ?, ?, ?, 2025-11-09 18:25:05, 2025-11-09 18:25:05))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Models/CustomerComprehensiveTest.php:79

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > customer can be sof…   
  Failed asserting that any soft deleted row in the table [customers] matches the attributes {"id":1}.

The table is empty.

  at tests/Unit/Models/CustomerComprehensiveTest.php:108
    104▕         $id = $customer->id;
    105▕         
    106▕         $customer->delete();
    107▕         
  ➜ 108▕         $this->assertSoftDeleted('customers', ['id' => $id]);
    109▕     }
    110▕ 
    111▕     public function test_customer_phone_accepts_various_formats()
    112▕     {

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > cus…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named phone (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "phone", "updated_at", "created_at") values (Saul, Runolfsdottir, ?, Insurance Claims Clerk, ?, 1, 1, ?, ?, [{"value":"http:\/\/www.buckridge.com\/"}], ?, 17423 Koch Wall Apt. 586, Lake Colbyburgh, ?, 87713-5934, PN, Enim totam qui nemo quidem. Voluptatem consequatur error maxime quidem minus. Inventore nesciunt aut suscipit voluptatem quos. In eos voluptatem sunt nihil repudiandae tenetur autem., +1 (555) 123-4567, 2025-11-09 18:25:06, 2025-11-09 18:25:06))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Models/CustomerComprehensiveTest.php:113

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > customer first name…   
  Failed asserting that exception of type "TypeError" matches expected exception "Illuminate\Database\QueryException". Message was: "App\Models\Customer::create(): Argument #1 ($email) must be of type string, array given, called in /var/www/html/tests/Unit/Models/CustomerComprehensiveTest.php on line 120" at
/var/www/html/app/Models/Customer.php:176
/var/www/html/tests/Unit/Models/CustomerComprehensiveTest.php:120
.

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > customer email is r…   
  Failed asserting that exception of type "TypeError" matches expected exception "Illuminate\Database\QueryException". Message was: "App\Models\Customer::create(): Argument #1 ($email) must be of type string, array given, called in /var/www/html/tests/Unit/Models/CustomerComprehensiveTest.php on line 129" at
/var/www/html/app/Models/Customer.php:176
/var/www/html/tests/Unit/Models/CustomerComprehensiveTest.php:129
.

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > cus…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (Thaddeus, Veum, ?, ?, ?, 1, 1, ?, ?, ?, ?, ?, ?, lt, ?, ?, Quibusdam mollitia recusandae rerum sed est fugit. Voluptas eius nesciunt aut beatae. Omnis consequatur quod eos nesciunt. Perspiciatis nulla distinctio cumque error rerum., valid@example.com, 2025-11-09 18:25:06, 2025-11-09 18:25:06))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Models/CustomerComprehensiveTest.php:157

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Models\CustomerComprehensiveTest > cus…  QueryException   
  SQLSTATE[HY000]: General error: 1 table customers has no column named email (Connection: sqlite, SQL: insert into "customers" ("first_name", "last_name", "company", "job_title", "photo_url", "photo_type", "channel", "channel_id", "phones", "websites", "social_profiles", "address", "city", "state", "zip", "country", "notes", "email", "updated_at", "created_at") values (Alfred, Casper, ?, Locksmith, ?, 1, 1, ?, [{"type":"work","value":"906.627.8575"}], [{"value":"http:\/\/mckenzie.net\/unde-sint-odio-quia-eligendi-veritatis-nihil-alias"}], ?, 1227 Jarret Walk, Amosshire, ao, ?, ?, Vitae quibusdam unde totam voluptas aperiam sint tempora. Quia sint saepe quo dolorem unde. Voluptatem cumque voluptatem omnis eos cupiditate rerum., original@example.com, 2025-11-09 18:25:06, 2025-11-09 18:25:06))

  at vendor/laravel/framework/src/Illuminate/Database/Connection.php:825
    821▕                     $this->getName(), $query, $this->prepareBindings($bindings), $e
    822▕                 );
    823▕             }
    824▕ 
  ➜ 825▕             throw new QueryException(
    826▕                 $this->getName(), $query, $this->prepareBindings($bindings), $e
    827▕             );
    828▕         }
    829▕     }

      [2m+18 vendor frames [22m
  19  tests/Unit/Models/CustomerComprehensiveTest.php:163

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Unit\Policies\AdvancedPolicyTest > guest cannot…   TypeError   
  App\Policies\MailboxPolicy::viewAny(): Argument #1 ($user) must be of type App\Models\User, null given, called in /var/www/html/tests/Unit/Policies/AdvancedPolicyTest.php on line 93

  at app/Policies/MailboxPolicy.php:19
     15▕ 
     16▕     /**
     17▕      * Determine whether the user can view any mailboxes.
     18▕      */
  ➜  19▕     public function viewAny(User $user): bool
     20▕     {
     21▕         return true; // All authenticated users can view mailboxes
     22▕     }
     23▕

  1   app/Policies/MailboxPolicy.php:19
  2   tests/Unit/Policies/AdvancedPolicyTest.php:93

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\Commands\ConfigureGmailMailbo…  AssertionFailedError   
  Output "Mailbox with ID abc not found!" was not printed.

  at tests/Feature/Commands/ConfigureGmailMailboxTest.php:297
    293▕     {
    294▕         // Act - Laravel will handle type coercion, but non-existent ID will fail
    295▕         $this->artisan('mailbox:configure-gmail', ['mailbox_id' => 'abc'])
    296▕             ->expectsOutput('Mailbox with ID abc not found!')
  ➜ 297▕             ->assertExitCode(1);
    298▕     }
    299▕ 
    300▕     /**
    301▕      * Test command preserves mailbox name during configuration.

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\ConversationAdvancedTest > search finds by subject     
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/ConversationAdvancedTest.php(499): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_finds_by_subject()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/ConversationAdvancedTest.php(499): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_finds_by_subject()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/ConversationAdvancedTest.php:501
    497▕             ]);
    498▕ 
    499▕         $response = $this->get(route('conversations.search', ['q' => 'Password']));
    500▕ 
  ➜ 501▕         $response->assertOk();
    502▕         $response->assertViewIs('conversations.search');
    503▕         $response->assertSee('Password Reset Help');
    504▕         $response->assertDontSee('Billing Question');
    505▕         $response->assertViewHas('conversations', function ($conversations) use ($targetConv, $otherConv) {

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\ConversationAdvancedTest > search finds by customer…   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/ConversationAdvancedTest.php(528): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_finds_by_customer_name()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/ConversationAdvancedTest.php(528): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_finds_by_customer_name()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/ConversationAdvancedTest.php:530
    526▕             ]);
    527▕ 
    528▕         $response = $this->get(route('conversations.search', ['q' => 'Sarah']));
    529▕ 
  ➜ 530▕         $response->assertOk();
    531▕         $response->assertSee('Technical Issue');
    532▕         $response->assertSee('Sarah');
    533▕     }
    534▕

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\ConversationAdvancedTest > search only shows author…   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/ConversationAdvancedTest.php(557): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_only_shows_authorized_mailboxes()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/ConversationAdvancedTest.php(557): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_only_shows_authorized_mailboxes()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/ConversationAdvancedTest.php:559
    555▕             ]);
    556▕ 
    557▕         $response = $this->get(route('conversations.search', ['q' => 'Conversation']));
    558▕ 
  ➜ 559▕         $response->assertOk();
    560▕         $response->assertSee('Authorized Conversation');
    561▕         $response->assertDontSee('Unauthorized Conversation');
    562▕     }
    563▕

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\ConversationAdvancedTest > admin search shows all m…   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/ConversationAdvancedTest.php(585): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_admin_search_shows_all_mailboxes()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/ConversationAdvancedTest.php(585): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_admin_search_shows_all_mailboxes()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/ConversationAdvancedTest.php:587
    583▕             ]);
    584▕ 
    585▕         $response = $this->get(route('conversations.search', ['q' => 'Search Test']));
    586▕ 
  ➜ 587▕         $response->assertOk();
    588▕         $response->assertViewIs('conversations.search');
    589▕         $response->assertSee('Mailbox 1 Search Test');
    590▕         $response->assertSee('Mailbox 2 Search Test');
    591▕         $response->assertViewHas('conversations', function ($conversations) use ($mailbox1Conv, $mailbox2Conv) {

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\ConversationAdvancedTest > search paginates results    
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/ConversationAdvancedTest.php(610): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_paginates_results()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/ConversationAdvancedTest.php(610): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\ConversationAdvancedTest->test_search_paginates_results()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/ConversationAdvancedTest.php:612
    608▕             ]);
    609▕ 
    610▕         $response = $this->get(route('conversations.search', ['q' => 'Test']));
    611▕ 
  ➜ 612▕         $response->assertOk();
    613▕         $response->assertViewHas('conversations');
    614▕         
    615▕         $conversations = $response->viewData('conversations');
    616▕         $this->assertEquals(50, $conversations->count());

  ────────────────────────────────────────────────────────────────────────────  
   FAILED  Tests\Feature\PaginationAndFilteringTest > conversation search wi…   
  Expected response status code [200] but received 500.
Failed asserting that 500 is identical to 200.

The following exception occurred during the last request:

TypeError: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php(141): htmlspecialchars()
#1 /var/www/html/storage/framework/views/afe9b74325a17025269f567d613955f6.php(13): e()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(123): require('...')
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/Filesystem/Filesystem.php(124): Illuminate\Filesystem\Filesystem::Illuminate\Filesystem\{closure}()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(58): Illuminate\Filesystem\Filesystem->getRequire()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#56 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#57 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#58 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#59 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#60 /var/www/html/tests/Feature/PaginationAndFilteringTest.php(80): Illuminate\Foundation\Testing\TestCase->get()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\PaginationAndFilteringTest->test_conversation_search_with_partial_match()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#64 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#66 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#67 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#68 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#69 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#70 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#71 {main}

Next Illuminate\View\ViewException: htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php) in /var/www/html/vendor/laravel/framework/src/Illuminate/Support/helpers.php:141
Stack trace:
#0 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/PhpEngine.php(60): Illuminate\View\Engines\CompilerEngine->handleViewException()
#1 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Engines/CompilerEngine.php(75): Illuminate\View\Engines\PhpEngine->evaluatePath()
#2 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(209): Illuminate\View\Engines\CompilerEngine->get()
#3 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(192): Illuminate\View\View->getContents()
#4 /var/www/html/vendor/laravel/framework/src/Illuminate/View/View.php(161): Illuminate\View\View->renderContents()
#5 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(79): Illuminate\View\View->render()
#6 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Response.php(35): Illuminate\Http\Response->setContent()
#7 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(920): Illuminate\Http\Response->__construct()
#8 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(887): Illuminate\Routing\Router::toResponse()
#9 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Routing\Router->prepareResponse()
#10 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Routing\Router->Illuminate\Routing\{closure}()
#11 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/EnsureEmailIsVerified.php(41): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#12 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\EnsureEmailIsVerified->handle()
#13 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Middleware/SubstituteBindings.php(51): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#14 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Routing\Middleware\SubstituteBindings->handle()
#15 /var/www/html/vendor/laravel/framework/src/Illuminate/Auth/Middleware/Authenticate.php(64): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#16 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Auth\Middleware\Authenticate->handle()
#17 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/VerifyCsrfToken.php(88): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#18 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\VerifyCsrfToken->handle()
#19 /var/www/html/vendor/laravel/framework/src/Illuminate/View/Middleware/ShareErrorsFromSession.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#20 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\View\Middleware\ShareErrorsFromSession->handle()
#21 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(121): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#22 /var/www/html/vendor/laravel/framework/src/Illuminate/Session/Middleware/StartSession.php(64): Illuminate\Session\Middleware\StartSession->handleStatefulRequest()
#23 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Session\Middleware\StartSession->handle()
#24 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/AddQueuedCookiesToResponse.php(37): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#25 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\AddQueuedCookiesToResponse->handle()
#26 /var/www/html/vendor/laravel/framework/src/Illuminate/Cookie/Middleware/EncryptCookies.php(75): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#27 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Cookie\Middleware\EncryptCookies->handle()
#28 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#29 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(807): Illuminate\Pipeline\Pipeline->then()
#30 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(786): Illuminate\Routing\Router->runRouteWithinStack()
#31 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(750): Illuminate\Routing\Router->runRoute()
#32 /var/www/html/vendor/laravel/framework/src/Illuminate/Routing/Router.php(739): Illuminate\Routing\Router->dispatchToRoute()
#33 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(201): Illuminate\Routing\Router->dispatch()
#34 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(170): Illuminate\Foundation\Http\Kernel->Illuminate\Foundation\Http\{closure}()
#35 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#36 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/ConvertEmptyStringsToNull.php(31): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#37 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\ConvertEmptyStringsToNull->handle()
#38 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TransformsRequest.php(21): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#39 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/TrimStrings.php(51): Illuminate\Foundation\Http\Middleware\TransformsRequest->handle()
#40 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\TrimStrings->handle()
#41 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/ValidatePostSize.php(27): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#42 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\ValidatePostSize->handle()
#43 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/PreventRequestsDuringMaintenance.php(110): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#44 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\PreventRequestsDuringMaintenance->handle()
#45 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/HandleCors.php(49): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#46 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\HandleCors->handle()
#47 /var/www/html/vendor/laravel/framework/src/Illuminate/Http/Middleware/TrustProxies.php(58): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#48 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Http\Middleware\TrustProxies->handle()
#49 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Middleware/InvokeDeferredCallbacks.php(22): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#50 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(209): Illuminate\Foundation\Http\Middleware\InvokeDeferredCallbacks->handle()
#51 /var/www/html/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(127): Illuminate\Pipeline\Pipeline->Illuminate\Pipeline\{closure}()
#52 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(176): Illuminate\Pipeline\Pipeline->then()
#53 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(145): Illuminate\Foundation\Http\Kernel->sendRequestThroughRouter()
#54 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(607): Illuminate\Foundation\Http\Kernel->handle()
#55 /var/www/html/vendor/laravel/framework/src/Illuminate/Foundation/Testing/Concerns/MakesHttpRequests.php(368): Illuminate\Foundation\Testing\TestCase->call()
#56 /var/www/html/tests/Feature/PaginationAndFilteringTest.php(80): Illuminate\Foundation\Testing\TestCase->get()
#57 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(1657): Tests\Feature\PaginationAndFilteringTest->test_conversation_search_with_partial_match()
#58 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(515): PHPUnit\Framework\TestCase->runTest()
#59 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestRunner/TestRunner.php(87): PHPUnit\Framework\TestCase->runBare()
#60 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestCase.php(361): PHPUnit\Framework\TestRunner->run()
#61 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestCase->run()
#62 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#63 /var/www/html/vendor/phpunit/phpunit/src/Framework/TestSuite.php(369): PHPUnit\Framework\TestSuite->run()
#64 /var/www/html/vendor/phpunit/phpunit/src/TextUI/TestRunner.php(64): PHPUnit\Framework\TestSuite->run()
#65 /var/www/html/vendor/phpunit/phpunit/src/TextUI/Application.php(211): PHPUnit\TextUI\TestRunner->run()
#66 /var/www/html/vendor/phpunit/phpunit/phpunit(104): PHPUnit\TextUI\Application->run()
#67 {main}

----------------------------------------------------------------------------------

htmlspecialchars(): Argument #1 ($string) must be of type string, Illuminate\Database\Eloquent\Builder given (View: /var/www/html/resources/views/conversations/search.blade.php)

  at tests/Feature/PaginationAndFilteringTest.php:82
     78▕         ]);
     79▕ 
     80▕         $response = $this->actingAs($user)->get(route('conversations.search', ['q' => 'Payment']));
     81▕ 
  ➜  82▕         $response->assertOk();
     83▕     }
     84▕ 
     85▕     public function test_mailbox_conversations_filter_by_assignment_status(): void
     86▕     {


  Tests:    45 failed, 1 skipped, 1282 passed (2997 assertions)
  Duration: 35.01s

